var DashboardPowerups=function(){let b=".grid-dashboard",c=".grid-viewport",d='[uitestid="gwt-debug-title"]',e='[uitestid="gwt-debug-custom-chart-single-value-formatted-value"] > span:first-of-type, [uitestid="gwt-debug-kpiValue"] > span:first-of-type, [uitestid="gwt-debug-dexp-visualization-single-value"] span:first-of-type, [uitestid="gwt-debug-visualization-single-value"] span:first-of-type, .powerupVlookup:not(.powerupOverridden) h1, .powerupMath:not(.powerupOverridden) h1, h1.powerupMath:not(.powerupOverridden)',f=".grid-tile",g='[uitestid="gwt-debug-legend"], [uitestid="gwt-debug-legendContainer"]',h='[uitestid="gwt-debug-MARKDOWN"] > div:first-child > div:first-child',i='[uitestid="gwt-debug-custom-chart-single-value-formatted-value"] span, [uitestid="gwt-debug-kpiValue"] span, [uitestid="gwt-debug-dexp-visualization-single-value"] span',j='[uitestid="gwt-debug-trendLabel"]',k='[uitestid="gwt-debug-map"]',l='span[uitestid="gwt-debug-WorldMapTile"]',m='[uitestid="gwt-debug-tablePanel"]',n='[uitestid="gwt-debug-tablePanel"] > div > div',o='[uitestid="gwt-debug-dashboardNameLabel"]',p='[uitestid="gwt-debug-showMoreTags"] ~ [title]',q='[uitestid="gwt-debug-funnelPanel"]',r='[uitestid="gwt-debug-chartPanel"], [uitestid="gwt-debug-dataExplorerTileVisualizationContainer"], [uitestid="gwt-debug-visualRepresentation"] [uitestid="gwt-debug-dtaqlTile"]',s='[uitestid="gwt-debug-custom-chart-single-value-title"]',t='[uitestid="gwt-debug-custom-chart-single-value-formatted-value"] > span:nth-of-type(2), [uitestid="gwt-debug-kpiValue"] > span:nth-of-type(2), [uitestid="gwt-debug-visualization-single-value"] > div:first-of-type > div > span:nth-of-type(2)',u=".powerupTable > div > div > div:nth-of-type(1) > span",v='[uitestid="gwt-debug-dashboard-tile-menu-icon"]',w='[uitestid="gwt-debug-dashboard-tile-menu-popup"]',x='[uitestid="gwt-debug-chartPanel"] > div:not([uitestid="gwt-debug-timeseries-tile-chart-root-panel"]), [uitestid="gwt-debug-visualization-top-list"]',y="div[data-dynamic-color]",z='div.grid-tileContent > div > div:nth-of-type(3) > div:nth-of-type(1), [uitestid="gwt-debug-renderedCustomError"] > div > div:nth-of-type(1)',A=".grid-tileContent > div:first-of-type > div:first-of-type",B=".grid-tileContent > div:first-of-type > div:nth-of-type(3)",C='[uitestid="gwt-debug-homeContextMenu"]',D='[uitestid="gwt-debug-dtaqlTile"]',E='[uitestid="gwt-debug-resolvedStartDate"]:visible',F='[uitestid="gwt-debug-resolvedEndDate"]:visible',G='[uitestid="gwt-debug-HEADER"] [uitestid="gwt-debug-inlineEditLabelViewText"]',H="!PU(color):",I="!PU(svg):",J="!PU(map):",K="!PU(link):",L="!PU(banner):",M="!PU(line):",N="!PU(usqlstack):",O="!PU(usqlcolor):",P="!PU(heatmap):",Q="!PU(sankey):",R="!PU(funnel):",S="!PU(math):",T="!PU(date):",U="!PU(gauge):",V="!PU(compare):",W="!PU(mcompare):",X="!PU(vlookup):",Y="!PU(stdev):",Z="!PU(100stack):",_="!PU(table):",aa="!PU(background):",aq="!PU(image):",ab="!PU(funnelcolors):",ac="!PU(forecast):",ad="!PU(tilecss):",ae="!PU(grid):",af="!PU(menu):",ag="!PU(topcolor):",ah="!PU(honeycomb):",ai="!PU(autohide):",aj="!PU(treemap):",ak="!PU(timeonpage):",al="!PU(cumulative):",am="!PU(ellipsis):",an="!PU(marky):",ar="ui/user-sessions/query?sessionquery=",ao=[H,I,K,J,L,M,N,P,R,Q,S,T,U,O,V,X,Y,Z,_,aa,W,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an],as="#c41425",at="#6d6d6d",au="#ffee7c",av="#6bcb8b",aw={},ax={animation:!1,allowPointSelect:!0,cursor:"crosshair",enableMouseTracking:!0,stickyTracking:!0,states:{hover:{enabled:!0,halo:{opacity:.25,size:10}}}},ay={enabled:!0,animation:!1,outside:!0,useHTML:!0,hideDelay:100,shared:!0,formatter:function(){if(void 0!==this.points)return this.points.reduce(function(j,a){let d=a.series.name,k=d.indexOf("\xa6")||28,b=d.substring(0,k)||"";b||(b=d);let l=$(a.series.chart.container),e=a.series.color,h=l.parents(f).find(g);if(h.length){a.series.index;let i=h.find(`svg[fill='${e}']`).parents(".gwt-HTML").text();i.length&&(b=i)}let c=Number(a.y);return c=Number.isNaN(c)?a.y:c.toLocaleString(void 0,{maximumFractionDigits:2}),j+`<div class="powerupLineTooltip">
                    <div class="dot" style="color: ${a.color}; background:${aM(e)}">● </div>
                    <div>${b}:</div>
                    <div class="spacer"></div>
                    <div>${c}</div>
                </div>`},"<b>"+Highcharts.dateFormat("%H:%M",this.x)+"</b>")}},az={enabled:!0,animation:!1,outside:!0,useHTML:!0,hideDelay:100,shared:!0,formatter:void 0,pointFormat:`<span style="color:{point.color}">●</span>: <b>{point.percentage:.1f}%</b><br/>`},aA={animation:!1,allowPointSelect:!0,cursor:"crosshair",enableMouseTracking:!0,stickyTracking:!0,states:{hover:{enabled:!0,halo:{opacity:.25,size:3}}}},aB={crosshair:{color:"#cccccc",width:"1px"}},aC={enabled:!0,color:"#ffffff",format:"{y:.2f}",crop:!0,overflow:"justify",style:{color:"#ffffff",fontSize:"10px",fontWeight:"",textOutline:""}},aD=[{name:"count",unit:"",conversions:[{unit:"",factor:1},{unit:"k",factor:.001},{unit:"mil",factor:1e-6},{unit:"bil",factor:1e-9}]},{name:"thousands",unit:"k",conversions:[{unit:"",factor:1e3},{unit:"k",factor:1},{unit:"mil",factor:.001},{unit:"bil",factor:1e-6}]},{name:"millions",unit:"mil",conversions:[{unit:"",factor:1e6},{unit:"k",factor:1e3},{unit:"mil",factor:1},{unit:"bil",factor:.001}]},{name:"billions",unit:"bil",conversions:[{unit:"",factor:1e9},{unit:"k",factor:1e6},{unit:"mil",factor:1e3},{unit:"bil",factor:1},]},{name:"bytes",unit:"B",conversions:[{unit:"B",factor:1},{unit:"kB",factor:.001},{unit:"MB",factor:1e-6},{unit:"GB",factor:1e-9},{unit:"TB",factor:1e-12}]},{name:"kilobytes",unit:"kB",conversions:[{unit:"B",factor:1e3},{unit:"kB",factor:1},{unit:"MB",factor:.001},{unit:"GB",factor:1e-6},{unit:"TB",factor:1e-9}]},{name:"megabytes",unit:"MB",conversions:[{unit:"B",factor:1e6},{unit:"kB",factor:1e3},{unit:"MB",factor:1},{unit:"GB",factor:.001},{unit:"TB",factor:1e-6}]},{name:"gigabytes",unit:"GB",conversions:[{unit:"B",factor:1e9},{unit:"kB",factor:1e6},{unit:"MB",factor:1e3},{unit:"GB",factor:1},{unit:"TB",factor:.001},]},{name:"terabytes",unit:"TB",conversions:[{unit:"B",factor:1e12},{unit:"kB",factor:1e9},{unit:"MB",factor:1e6},{unit:"GB",factor:1e3},{unit:"TB",factor:1},]},{name:"bytes per second",unit:"B/s",conversions:[{unit:"B/s",factor:1},{unit:"kB/s",factor:.001},{unit:"MB/s",factor:1e-6},{unit:"GB/s",factor:1e-9}]},{name:"kilobytes per second",unit:"kB/s",conversions:[{unit:"B/s",factor:1e3},{unit:"kB/s",factor:1},{unit:"MB/s",factor:.001},{unit:"GB/s",factor:1e-6}]},{name:"megabytes per second",unit:"MB/s",conversions:[{unit:"B/s",factor:1e6},{unit:"kB/s",factor:1e3},{unit:"MB/s",factor:1},{unit:"GB/s",factor:.001}]},{name:"gigabytes per second",unit:"GB/s",conversions:[{unit:"B/s",factor:1e9},{unit:"kB/s",factor:1e6},{unit:"MB/s",factor:1e3},{unit:"GB/s",factor:1},]},{name:"nanoseconds",unit:"ns",conversions:[{unit:"ns",factor:1},{unit:"\xb5s",factor:.001},{unit:"ms",factor:1e-6},{unit:"s",factor:1e-9},{unit:"mins",factor:1e-9/60},{unit:"hs",factor:1e-9/60/60}]},{name:"microseconds",unit:"\xb5s",conversions:[{unit:"ns",factor:1e3},{unit:"\xb5s",factor:1},{unit:"ms",factor:.001},{unit:"s",factor:1e-6},{unit:"mins",factor:1e-6/60},{unit:"hs",factor:1e-6/60/60}]},{name:"milliseconds",unit:"ms",conversions:[{unit:"ns",factor:1e6},{unit:"\xb5s",factor:1e3},{unit:"ms",factor:1},{unit:"s",factor:.001},{unit:"mins",factor:.001/60},{unit:"hs",factor:.001/60/60}]},{name:"seconds",unit:"s",conversions:[{unit:"ns",factor:1e9},{unit:"\xb5s",factor:1e6},{unit:"ms",factor:1e3},{unit:"s",factor:1},{unit:"mins",factor:1/60},{unit:"hs",factor:1/60/60}]},{name:"minutes",unit:"mins",conversions:[{unit:"ns",factor:1e9*60},{unit:"\xb5s",factor:6e7},{unit:"ms",factor:6e4},{unit:"s",factor:60},{unit:"mins",factor:1},{unit:"hs",factor:1/60}]},{name:"hours",unit:"hs",conversions:[{unit:"ns",factor:36e11},{unit:"\xb5s",factor:36e8},{unit:"ms",factor:36e5},{unit:"s",factor:3600},{unit:"mins",factor:60},{unit:"hs",factor:1}]},],aE={attributes:!0,childList:!0,subtree:!0};var ap,aF=[],aG=[],aH=[],aI=!1,aJ={},aK=(ap=0,function(){return ap++});let aL=(a,b)=>{let c;return function(...e){let d=()=>{clearTimeout(c),a(...e)};clearTimeout(c),c=setTimeout(d,b)}},aM=c=>{let a=d3.rgb(c),b=.2126*a.r/255+.7152*a.g/255+.0722*a.b/255;return(b+.05)/.05>1.05/(b+.05)?"black":"white"},aN=(a,b)=>{Highcharts.charts.filter(a=>void 0!==a).forEach(c=>{let d=$(c.container).parent();$(c.container).parents(f)[0]===a[0]&&d.is(b)&&(console.log(`POWERUP: INFO - Destroy old chart (index:${c.index})`),c.destroy(),d.remove())})},aO=(a,c,d=5)=>{if(d<1){let b=`POWERUP: CRITICAL - failed to load Highcharts module ${a}`;console.log(b),aS(b);return}a in Highcharts.seriesTypes?c():setTimeout(()=>{aO(a,c,d-1)},100)},aP=(e,f)=>{let c=e.split(f);c.shift(),c.length;let d=[];c.forEach(c=>{let b=c.split(/(!PU|\n)/)[0].trim(),a=b.split(";").map(a=>a.split("="));a.argstring=b,d.push(a),a.forEach(c=>{let b=c[0];b.length&&(a.hasOwnProperty(b)||(a[b]=c[1]))})});let a=d[0]||{};if(a.argObjs=d,a.argstring.includes("url=")){let b=(a.argstring.match(/url=([^ ]+)/)||[])[1];b&&(b=b.trim()),b&&(a.url=b)}return a};function aQ(t,u=!0,l=!1,o=!0){let f=$(t);if(!f.length)return!1;let c=[],p=[],g=[],h=[],i=[],q=f.find(m),r=f.find(".powerupNewTable");r.length&&(q=r),q.find(n.replace(m,"")).each(function(b,a){$(a).children().each(function(a,f){let d=$(f);if(void 0===c[b]&&(c[b]=[]),c[b][a]=d.text(),l&&0===b&&(h[a]=d.find("span").css("border-left-color")),o){let e=d.find("a");e.length&&(i[a]=e.attr("href"))}})});let e=c.length;if(!e)return!1;for(let j=0;j<e;j++)g.push(c[j].shift());l&&h.length&&h.shift(),o&&i.length&&i.shift();let v=c[0].length;for(let a=0;a<v;a++){let d={};for(let b=0;b<e;b++){let k=g[b];if(u&&b==e-1&&null!=c[b][a])d[k]=Number(c[b][a].replace(/[,a-z %]/g,""));else{let s=Number(c[b][a]);isNaN(s)?d[k]=c[b][a]||0:d[k]=s}l&&(d.color=h[a]),o&&(d.link=i[a])}p.push(d)}return{keys:g,normalTable:p}}function aR(b,c="",d=!0){let f=/\/\d+(\/.*)?$/,a=[];if("["!=b.substring(0,1)||"]"!=b.substr(-1))return b;if(d)try{a=JSON.parse(b)}catch(g){}a.length||(a=b.substr(1,b.length-2).split(", "));try{"useraction.matchingConversionGoals"===c&&(a=a.map(a=>Array.isArray(a)?a.join(", "):a)),a=a.map(a=>"string"==typeof a?a.trim():a).map(a=>"string"==typeof a?a.replace(f,"/*$1"):a)}catch(e){console.warn([e,b])}return a}function aS(b){if(a.config.Powerups.BeaconOptOut)return!1;a.config.Powerups.debug&&console.log("POWERUP: DEBUG - OpenKit crash beacon"),window.postMessage({OpenKit:"error_beacon",context:"clientside",err:b},"*")}function aT(d,e="Deprecated..."){let c=$(d).find(v);if(!c.length)return!1;let b=c.prev(".powerupDepIcon");if(b.length)return!0;b=$("<div>").addClass("powerupDepIcon").html(`<img src='${a.SVGLib()+"jewel.svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-icon-gray'>`).insertBefore(c),$tooltip=$('<div class="powerupDepIconTooltip">').html(`<span class="powerupDepIconTooltipText">${e}</span>`),b.on("mouseover",()=>{let a=b.offset();$tooltip.appendTo("body").offset(a)}),b.on("mouseout click",()=>{$tooltip.detach()})}var a={};a.POWERUP_EXT_URL="",a.SELECTORS={GRID_SELECTOR:b,VIEWPORT_SELECTOR:c,TITLE_SELECTOR:d,VAL_SELECTOR:e,TILE_SELECTOR:f,LEGEND_SELECTOR:g,MARKDOWN_SELECTOR:h,BIGNUM_SELECTOR:i,VLOOKUP_BIGNUM_SELECTOR:".powerupVlookup h1",TREND_SELECTOR:j,MAP_SELECTOR:k,MAPTITLE_SELECTOR:l,TABLE_SELECTOR:m,TABLE_COL_SELECTOR:n,BANNER_SELECTOR:o,TAG_SELECTOR:p,FUNNEL_SELECTOR:q,SVT_PANEL_SELECTOR:r,SVT_METRIC_SELECTOR:s,SVT_UNITS_SELECTOR:t,COLUMN_SELECTOR:u,MENU_ICON_SELECTOR:v,MENU_POPUP_SELECTOR:w,TOPLIST_SELECTOR:x,TOPLIST_BAR_SELECTOR:y,NO_DATA_SELECTOR:z,TILE_CONTENT_SELECTOR:A,TILE_NOCONTENT_SELECTOR:B,DASHBOARD_MENU_SELECTOR:C,USQL_SELECTOR:D,START_DATE_SELECTOR:E,END_DATE_SELECTOR:F,HEADER_SELECTOR:G},a.MARKERS=ao,a.SVGLib=()=>a.POWERUP_EXT_URL+encodeURI("3rdParty/node_modules/@dynatrace/barista-icons/"),a.config={},a.PUHighchartsMutex={blocking:!1,blocked:0},a.PUHighchartsStatus=()=>Highcharts.charts.filter(a=>void 0!==a).map(a=>a.poweredup),a.SVGInject=(b,c=5)=>{if("undefined"==typeof SVGInject){if(c<1)return!1;setTimeout(()=>{a.SVGInject(b,c-1)},100)}else SVGInject(b)},a.PUHighcharts=function(){if(!(window.location.hash.startsWith("#dashboard;")||window.location.hash.startsWith("#dashboard/dashboard;")))return a.config.Powerups.debug&&console.log("Powerup: no longer on a dashboard, removing PUHighcharts listener..."),Highcharts.removeEvent(Highcharts.Chart,"load",a.PUHighcharts),!1;{if(a.PUHighchartsMutex.blocking){if(a.PUHighchartsMutex.blocked++,a.PUHighchartsMutex.blocked%100==0){let b="Powerup: WARN - PUHighcharts mutex blocked, skipped "+a.PUHighchartsMutex.blocked;console.log(b),aS(b)}return!1}a.PUHighchartsMutex.blocking=!0,a.config.Powerups.debug&&console.log("Powerup: powering-up Highcharts...");let e=0,c=[],d=new $.Deferred;return Highcharts.wrap(Highcharts.Chart.prototype,"contextMenu",function(c){if(c.apply(this,Array.prototype.slice.call(arguments,1)),void 0===this.exportContextMenu.style.originalTop){var a=Highcharts.offset(this.container),b=10;this.exportContextMenu.style.top=parseInt(this.exportContextMenu.style.top)+a.top+"px",this.exportContextMenu.style.left=a.left+this.chartWidth-this.exportMenuWidth-parseInt(this.exportContextMenu.style.padding)-b+"px",this.exportContextMenu.style.width=this.exportMenuWidth+"px",this.exportContextMenu.style.originalTop=this.exportContextMenu.style.top,Highcharts.doc.body.appendChild(this.exportContextMenu),this.exportContextMenu.poweredup=!0}else{var a=Highcharts.offset(this.container),b=10;this.exportContextMenu.style.top=this.exportContextMenu.style.originalTop}}),Highcharts.charts.filter(a=>void 0!==a).filter(a=>!a.PowerUpCreated).filter(a=>void 0!==a.container).filter(a=>"sankey"!=a.options.type&&"heatmap"!=a.options.type).forEach(d=>{let b=a.PUHighchart(d);c.push(b),$.when(b).done(a=>{a&&e++})}),$.when.apply($,c).then(function(){$(".highcharts-container").css("z-index",999),a.config.Powerups.debug&&console.log("Powerup: "+e+" Highcharts powered-up."),d.resolve(!0),a.PUHighchartsMutex.blocking=!1,a.PUHighchartsMutex.blocked=0}),d}},a.PUHighchart=function(b){$(b.container).parents(f);let g=!1;var q={enabled:!0,fallbackToExportServer:!0,libURL:a.POWERUP_EXT_URL+"3rdParty/Highcharts/lib",buttons:{contextButton:{menuItems:["downloadSVG","downloadPDF","separator","downloadCSV","downloadXLS","printChart"]}}};let r=function(b,c){for(var a in b){if(b.hasOwnProperty(a)!==c.hasOwnProperty(a))return!1;switch(typeof b[a]){case"object":if(!r(b[a],c[a]))return!1;break;case"function":if(void 0===c[a]||"compare"!=a&&b[a].toString()!=c[a].toString())return!1;break;default:if(b[a]!=c[a])return!1}}return!0},h=function(){let a=$(b.container);r(q,b.options.exporting)||(b.update({exporting:q},!1),g=!0),a.off("mouseenter.powerup").on("mouseenter.powerup",b=>{a.find(".highcharts-exporting-group").addClass("powerupVisible")}).off("mouseleave.powerup").on("mouseleave.powerup",b=>{a.find(".highcharts-exporting-group").removeClass("powerupVisible")})},s=function(){$(b.container).find(".highcharts-plot-background").off("touchstart.powerup").on("touchstart.powerup",a=>{b.pointer.onContainerTouchStart(a),a.stopImmediatePropagation()}).off("touchmove.powerup").on("touchmove.powerup",a=>{b.pointer.onContainerTouchMove(a),a.stopImmediatePropagation()}).off("click.powerup").on("click.powerup",a=>{a.stopImmediatePropagation()}).addClass("powerupPlotBackground")};var i=function(){b.series.forEach(a=>{r(ax,a.options)||(a.update(ax,!1),g=!0)}),r(aw,b.options.chart)||(b.update({chart:aw},!1),g=!0),void 0!==b.tooltip.options.userOptions&&b.tooltip.options.userOptions.enabled||(b.update({tooltip:ay},!1),g=!0),r(aB,b.xAxis[0].options)||(b.update({xAxis:aB},!1),g=!0),r(aB,b.yAxis[0].options)||(b.update({yAxis:aB},!1),g=!0),s()},o=function(){b.series.forEach(a=>{r(aA,a.options)||(a.update(aA,!1),g=!0),void 0!==b.tooltip.options.userOptions&&b.tooltip.options.userOptions.enabled||(b.update({tooltip:az},!1),g=!0)}),s()};if(void 0===b|| void 0===b.container)return!1;{let p=new $.Deferred,e=[],j=$(b.container).parents(f),c=j.find(d).text();if(c.includes(M)&&(aT(j,"PU_Line deprecated. Please use Data Explorer."),a.PULine(b,c)&&(g=!0,i(),h(),aJ.PU_LINE?aJ.PU_LINE++:aJ.PU_LINE=1)),c.includes(N)){let k=a.PUUsqlStack(b,c);e.push(k),$.when(k).done(a=>{s(),h(),a&&(g=!0),aJ.PU_USQLSTACK?aJ.PU_USQLSTACK++:aJ.PU_USQLSTACK=1})}if(c.includes(P)&&(a.PUHeatmap(b,c,b.newContainer)&&(g=!0),aJ.PU_HEATMAP?aJ.PU_HEATMAP++:aJ.PU_HEATMAP=1),c.includes(Z)&&(function(a,b){let c=aP(b,Z),d=Number((c.find(a=>"pad"==a[0])||[])[1]);a.series.forEach((b,c)=>{if("column"===b.options.type){let a={stack:"stack0",stacking:"percent"};isNaN(d)||(a.pointPadding=d,a.groupPadding=d,a.borderWidth=0,a.shadow=!1),b.update(a,!1),b.yAxis.setExtremes(0,100)}})}(b,c)&&(g=!0),aJ.PU_100STACK?aJ.PU_100STACK++:aJ.PU_100STACK=1),c.includes(ac)){let l=a.PUforecast(b,c);e.push(l),$.when(l).done(a=>{a&&(g=!0),i(),h(),aJ.PU_FORECAST?aJ.PU_FORECAST++:aJ.PU_FORECAST=1})}if(c.includes(al)){let m=a.PUcumulative(b,c);e.push(m),$.when(m).done(a=>{a&&(g=!0),i(),h(),aJ.PU_CUMULATIVE?aJ.PU_CUMULATIVE++:aJ.PU_CUMULATIVE=1})}if(c.includes(O)){let n=a.PUUsqlColor(b,c);e.push(n),$.when(n).done(a=>{b.series[0]&&"pie"==b.series[0].type?o():(i(),h()),s(),a&&(g=!0),aJ.PU_USQLCOLOR?aJ.PU_USQLCOLOR++:aJ.PU_USQLCOLOR=1})}return a.config.Powerups.tooltipPU&&(b.series[0]&&"pie"==b.series[0].type?(o(),h()):(i(),h())),$.when.apply($,e).then(()=>{if(g)try{Object.keys(b).length?("heatmap"in Highcharts.seriesTypes&& void 0===b.colorAxis&&(b.colorAxis=[]),b.redraw(!1)):console.log("Powerup: DEBUG - ignoring empty chart")}catch(a){let c=`Powerup: CRITICAL - failed to redraw. ${a.name}: ${a.message}`;console.log(c),console.log(a),console.log(b),aS(c)}p.resolve(!0)}),p}},a.PUcumulative=function(d,k){if(void 0===d)return!1;let i=d.series[0].options.data.filter(a=>null!==a[1]&&!isNaN(a[1])),n=0,c=aP(k,al),h=$(d.container),l=h.parents(f),e=(c.find(a=>"cast"==a[0])||[])[1]||0,o=Number((c.find(a=>"lim"==a[0])||[])[1]),p=(c.find(a=>"castcolor"==a[0])||[])[1]||"#14a8f5",q=(c.find(a=>"limcolor"==a[0])||[])[1]||"#dc172a",r=(c.find(a=>"warncolor"==a[0])||[])[1]||"#ffe11c",s=(c.find(a=>"warncolor"==a[0])||[])[1]||"#dc172a";e=e.includes("%")?Math.round((e=.01*Number(e.split("%")[0]))*i.length):Number(e),aN(l,".powerupCumulative"),h.parent().addClass("powerupHide"),$(g).addClass("powerupHide");let j=$("<div>").addClass("powerupCumulative").css("width","100%").css("height","100%").insertAfter(h.parent()),m=[];if(i.forEach(a=>{n+=a[1],m.push([a[0],n])}),void 0===d.userOptions)return!1;let b=JSON.parse(JSON.stringify(d.userOptions));b.series[0].data=m,b.series[0].showInLegend=!0,b.chart.renderTo=j[0],Object.keys(b).forEach(a=>{Array.isArray(b[a])?b[a].forEach(a=>{"object"==typeof a&&a.hasOwnProperty("id")&&delete a.id}):"object"==typeof b[a]&&null!=b[a]&&b[a].hasOwnProperty("id")&&delete b[a].id}),b.legend||(b.legend={}),b.legend.enabled=!0,b.title||(b.title={}),b.title.text="Cumulative",Highcharts.chart(j[0],b,c=>{c.PowerUpCreated=!0;let f=`!PU(forecast):p=${e};colors=${p};range=false;leg=Linear,Projection`;a.PUforecast(c,f),c.series[0].update({name:b.series[0].name+" (cumulative)"},!1),o&&c.yAxis[0].update({plotLines:[{color:q,value:o,width:2}]},!0);let d,g=c.series[0].userOptions.data,h=c.series.filter(a=>"Projection"==a.userOptions.id)[0].userOptions.data;(d=g.find(a=>a[1]>=o))?c.xAxis[0].update({plotLines:[{color:s,value:d[0],width:2,label:{text:new Date(d[0]).toLocaleString(),verticalAlign:"bottom",align:"right",y:-5,style:{color:"white",fontSize:"10px",textOutline:!1}}}]},!0):(d=h.find(a=>a[1]>=o))&&c.xAxis[0].update({plotLines:[{color:r,value:d[0],width:2,label:{text:new Date(d[0]).toLocaleString(),verticalAlign:"bottom",align:"right",y:-5,style:{color:"white",fontSize:"10px",textOutline:!1}}}]},!0)})},a.PUforecast=function(a,s){let t=["SMA","EMA","Mean","Stdev","Bands","Linear"],c=a.series[0].data,u=c.filter(a=>null!=a.y).map(a=>[a.x,a.y]),b=aP(s,ac),j=((b.find(a=>"analysis"==a[0])||[])[1]||"Linear").split(","),k=((b.find(a=>"leg"==a[0])||[])[1]||t.join(",")).split(","),h=Number((b.find(a=>"zIndex"==a[0])||[])[1]),y="false"!=(b.find(a=>"range"==a[0])||[])[1];isNaN(h)&&(h=void 0);let z=((b.find(a=>"colors"==a[0])||[])[1]||"#2ab6f4,#4fd5e0,#748cff,#4fd5e0,#fd8232").split(","),d=(b.find(a=>"n"==a[0])||[])[1]||"20%";d=d.includes("%")?Math.round((d=.01*Number(d.split("%")[0]))*c.length):Number(d);let e=(b.find(a=>"p"==a[0])||[])[1]||"0";e=e.includes("%")?Math.round((e=.01*Number(e.split("%")[0]))*c.length):Number(e),a.series.filter(a=>t.includes(a.id)).forEach(a=>{a.remove(!0)}),a.series.filter(a=>void 0===a.id&&a.index).forEach(a=>{a.remove(!0)});let l=$(a.container),A=a.series.filter(a=>void 0!==a.group).map(a=>a.group.element);l.find(".highcharts-series").each((b,a)=>{A.includes(a)||$(a).remove()});let m=l.parents(f).find(g).hide().find("[title]").eq(0).attr("title");function n(){let b=a.series.length;return b%=z.length,z[b]}function v(a){let b=0,g=0,i=0,j=0,c=0;for(let d=0;d<a.length;d++){if(null==a[d][1])continue;let f=a[d][0],k=a[d][1];b+=f,g+=k,j+=f*f,i+=f*k,c++}let h=(c*i-b*g)/(c*j-b*b),l=g/c-h*b/c,m=[];for(let e=0;e<a.length;e++){if(null==a[e][1])continue;let n=[a[e][0],a[e][0]*h+l];m.push(n)}return{m:h,b:l,line:m}}function B(a){if(!e|| void 0===a)return;let b=a.line.length;if(b<2)return;let g=a.line[b-1][0]-a.line[b-2][0],d=[];for(let c=1;c<=e;c++){let f=a.line[b-1][0]+c*g,h=a.m*f+a.b;d.push([f,h])}return d}null!=m&&a.series[0].update({name:m},!1),a.legend.update({enabled:!0,itemStyle:{color:"#B7B7B8",fontSize:"10px",fontWeight:"normal"},itemHoverStyle:{color:"white"}},!1),function(){let f=[];for(let b=0;b<c.length;b++){let g=[],i=0,l=Math.max(0,b-d+1),m=b,o=m-l+1;for(let e=l;e<=m;e++)i+=c[e].y;let p=i/o;g=null!=c[b].y?[c[b].x,p]:[c[b].x,null],f.push(g)}a.addSeries({name:"SMA",id:"SMA",data:f,color:n(),visible:j.includes("SMA"),zIndex:h,showInLegend:k.includes("SMA")},!1)}();let w=function(){let b=[];b[0]=[c[0].x,c[0].y];for(let e=1;e<c.length;e++){if(null==c[e].y)continue;let f=Math.max(e-1,0),g=2/(d+1);if(void 0===b[f])continue;let i=c[e].y*g+b[f][1]*(1-g);b.push([c[e].x,i])}return a.addSeries({name:"EMA",id:"EMA",data:b,color:n(),visible:j.includes("EMA"),zIndex:h,showInLegend:k.includes("EMA")},!1),b}(),o,p,q,r;!function(f){if(!y)return;let b=[],d=[],e=0;c.forEach(a=>{null!=a.y&&(b.push(a.y-f),e++)});let g=Math.sqrt(b.reduce((b,a)=>b+a*a,0)/e);c.forEach(a=>{null!=a.y&&d.push([a.x,f-g,f+g])}),a.addSeries({name:"Stdev",id:"Stdev",type:"arearange",data:d,color:a.get("Mean").color,opacity:.3,linkedTo:"Mean",visible:j.includes("Mean"),zIndex:h,showInLegend:k.includes("Stdev")},!1)}((o=[],p=0,q=0,c.forEach(a=>{null!=a.y&&(p+=a.y,q++)}),r=p/q,c.forEach(a=>{null!=a.y&&o.push([a.x,r])}),a.addSeries({name:"Mean",id:"Mean",data:o,color:n(),visible:j.includes("Mean"),zIndex:h,showInLegend:k.includes("Mean")},!1),r));let x=function(f){if(!y)return;let g=[],i=[],r=0;c.forEach((a,b)=>{null!=a.y&& void 0!==f[b]&&(g.push(a.y-f[b][1]),r++)});for(let b=0;b<g.length;b++){let l=[],m=0,n=Math.max(0,b-d+1),o=b,q=o-n+1;for(let e=n;e<=o;e++)m+=g[e]*g[e];let p=Math.sqrt(m/q);null!=c[b].y&&(l=[f[b][0],f[b][1]-p,f[b][1]+p],i.push(l))}return a.addSeries({name:"Bands",id:"Bands",type:"arearange",data:i,color:a.get("EMA").color,opacity:.3,linkedTo:"EMA",visible:j.includes("EMA"),zIndex:h,showInLegend:k.includes("Bands")},!1),i}(w),i;return function(d){if(!e)return;let b=B(d);if(void 0==b)return!1;a.addSeries({name:"Projection",id:"Projection",data:b,color:n(),dashStyle:"shortDash",zIndex:h,showInLegend:k.includes("Projection")},!1),a.axes.filter(a=>a.isXAxis)[0].setExtremes(c[0].x,b[b.length-1][0],!1)}((i=v(u),a.addSeries({name:"Linear",id:"Linear",data:i.line,color:n(),visible:j.includes("Linear"),zIndex:h,showInLegend:k.includes("Linear")},!1),i)),function(d){if(!e||!y)return;let g=d.map(a=>[a[0],a[2]]),i=d.map(a=>[a[0],a[1]]),j=v(g),l=v(i),m=B(j)||[],f=B(l)||[],b=[];f.length&&m.length&&(f.forEach((a,c)=>{b.push([a[0],a[1],m[c][1]])}),a.addSeries({name:"RangeProjection",id:"RangeProjection",data:b,color:n(),type:"arearange",linkedTo:"Projection",opacity:.3,zIndex:h,showInLegend:k.includes("RangeProjection")},!1),a.axes.filter(a=>a.isXAxis)[0].setExtremes(c[0].x,b[b.length-1][0],!1))}(x),a.axes.filter(a=>void 0===a.isXAxis&&a.series.length).forEach(b=>{let c=0,d=0;b.series.forEach(a=>{Array.isArray(a.userOptions.data[0])?(c=Math.min.apply(Math,a.userOptions.data.map(a=>a[1]).concat([c])),d=Math.max.apply(Math,a.userOptions.data.map(a=>a[1]).concat([d]))):"object"==typeof a.userOptions.data[0]&&(c=Math.min.apply(Math,a.userOptions.data.map(a=>a.y).concat([c])),d=Math.max.apply(Math,a.userOptions.data.map(a=>a.y).concat([d])))});let a=b.tickInterval;c=Math.round(.9*c/a)*a,d=Math.round(1.1*d/a)*a,b.setExtremes(c,d,!1)}),!0},a.PULine=function(d,h){if(!a.config.Powerups.linePU)return;let b=aP(h,M),c=(b.find(a=>"thld"==a[0])||[])[1],e=(b.find(a=>"hcol"==a[0])||[])[1],f=(b.find(a=>"lcol"==a[0])||[])[1];if(b.length<3|| void 0==c|| void 0==e|| void 0==f){let g=`Powerup: ERROR - ${M} - invalid argstring: ${b.argstring}`;return console.log(g),aS(g),!1}let i={threshold:c,negativeColor:f,color:e};return d.series[0].update(i),d.yAxis[0].addPlotLine({value:c,color:"yellow",width:1}),!0},a.PUUsqlStack=function(b,g,k=3){if(!a.config.Powerups.usqlstackPU)return!1;let d=new $.Deferred,c=aP(g,N);if(c.length<1){let h="Powerup: ERROR - invalid argstring: "+c.argstring;return console.log(h),aS(h),!1}let e=(c.find(a=>"colors"==a[0])||[])[1];e&&(e=e.split(","));let f=(c.find(a=>"vals"==a[0])||[])[1];f&&(f=f.split(","));let n=g.includes(Z)?"percent":"normal",o="true"===(c.find(a=>"dataLabels"==a[0])||["dataLabels","false"])[1].toLowerCase().trim();if(b.series.length>1)return b.series.forEach((c,a)=>{let b={stack:"stack0",stacking:n,dataLabels:{enabled:o},groupPadding:0};if(f){let g=(c.name.match(/\(([^)]+)/)||[])[1]||"",d=f.findIndex(a=>a.toLowerCase()===g.toLowerCase());d> -1?b.color=e[d]:e&&Array.isArray(e)&&e[a]&&(b.color=e[a])}else e&&Array.isArray(e)&&e[a]&&(b.color=e[a]);c.update(b,!1)}),b.redraw(!1),!0;if(b.series.length<1){let i="Powerup: WARN - USQLStack did not find a series, aborting.";return console.log(i),aS(i),!1}if(!b.series[0].data.length)return!!k&&(setTimeout(()=>{let c=a.PUUsqlStack(b,g,k-1);$.when(c).done(a=>{d.resolve(a)})},50),d);if(void 0==b||!Array.isArray(b.series)|| void 0==b.series[0]||!Array.isArray(b.series[0].data)|| void 0==b.series[0].data[0]|| void 0==b.series[0].data[0].name||!b.series[0].data[0].name.includes(",")){let j="Powerup: WARN - USQLStack did not find a splitting, aborting.";return console.log(j),aS(j),!1}let p=[],l=[],m=[...new Set(b.series[0].data.map(a=>a.category.split(",")[0]))];return b.series[0].data.forEach(d=>{let h=d.name.split(","),g=h[0],i=h[1].trim(),j=p.findIndex(a=>a==i);if(j<0){p.push(i);let a={name:b.series[0].name+`(${i})`,type:"bar",cursor:"crosshair",stacking:n,dataLabels:{enabled:o},data:[{name:g,x:m.findIndex(a=>a===g),y:d.y}]},c=l.length;if(f){let k=f.findIndex(a=>a.toLowerCase()===i.toLowerCase());k> -1?a.color=e[k]:e&&Array.isArray(e)&&e[c]&&(a.color=e[c])}else e&&Array.isArray(e)&&e[c]&&(a.color=e[c]);l.push(a)}else l[j].data.push({name:g,x:m.findIndex(a=>a===g),y:d.y});0>m.findIndex(a=>a==g)&&m.push(g)}),b.series[0].remove(!1,!1),b.axes[0].setCategories(m,!1),l.forEach((a,c)=>{b.addSeries(a,!1,!1)}),b.update({chart:aw},!1),b.redraw(!1),$(".highcharts-exporting-group").addClass("powerupVisible"),d.resolve(!0),d},a.PUUsqlColor=function(b,g,j=3){if(!a.config.Powerups.usqlcolorPU)return!1;new $.Deferred;let c=aP(g,O);if(c.length<1){let f="Powerup: ERROR - invalid argstring: "+c.argstring;return console.log(f),aS(f),!1}let d=(c.find(a=>"colors"==a[0])||[])[1],h="true"===(c.find(a=>"dataLabels"==a[0])||["dataLabels","false"])[1].toLowerCase().trim(),e=(c.find(a=>"vals"==a[0])||[])[1];if(!d)return!1;if(d=d.split(","),e)e=e.split(","),b.series[0].data.forEach(b=>{let a=e.findIndex(a=>a.toLowerCase()===b.name.toLowerCase());a> -1&&b.update({color:d[a]},!1)});else{let i={colors:d};b.update(i,!1),b.series.forEach((a,b)=>{a.color&&a.update({color:d[b]})})}if(h){let k={dataLabels:{...aC}};b.series.forEach(a=>{a.update(k,!1)})}return b.redraw(!1),!0},a.highlightPointsInOtherCharts=function(i){if(!a.config.Powerups.tooltipPU)return;let l=i.currentTarget,d=Highcharts.charts.filter(a=>void 0!==a&& void 0!==a.options).filter(a=>"sankey"!=a.options.type&&"heatmap"!=a.options.type),g=d.findIndex(a=>a.container===l);if(g> -1){var e;let j=d[g],m=j.pointer.normalize(i.originalEvent);if(j.series.forEach((a,b)=>{e||(e=a.searchPoint(m,!0))}),e&&e.series&&e.series.xAxis&&e.series.yAxis){let k=e.x;for(let f=0;f<d.length;f++)if(f!=g)for(let h=0;h<d[f].series.length;h++){let b=d[f].series[h].points;if(b&&b.length){for(let c=0;c<b.length;c++)if(b[c].x===k&&b[c].series.xAxis&&b[c].series.yAxis){b[c].series.xAxis.drawCrosshair(void 0,b[c]),b[c].series.yAxis.drawCrosshair(void 0,b[c]);break}}}}}},a.removeHighlightPointsInOtherCharts=function(c){let b=Highcharts.charts.filter(a=>void 0!==a);for(let a=0;a<b.length;a++)Array.isArray(b[a].xAxis)&&b[a].xAxis[0].hideCrosshair()},a.loadChartSync=function(){$('[uitestid="gwt-debug-dashboardGrid"]').off("mouseover",".highcharts-container"),$('[uitestid="gwt-debug-dashboardGrid"]').off("mouseout",".highcharts-container"),$('[uitestid="gwt-debug-dashboardGrid"]').on("mouseover",".highcharts-container",aL(a.highlightPointsInOtherCharts,50)),$('[uitestid="gwt-debug-dashboardGrid"]').on("mouseout",".highcharts-container",a.removeHighlightPointsInOtherCharts)},a.cleanMarkup=function(){let b=new $.Deferred;return a.config.Powerups.debug&&console.log("Powerup: DEBUG - clean power-up markup"),$(d).each((f,d)=>{let c=$(d);if(c.children(".powerup-markup").length)return!0;let b=c.text(),a=b.length;a=ao.reduce((c,d)=>b.includes(d)?Math.min(b.indexOf(d),c):Math.min(c,a),a);let e=b.substring(0,a)+'<span class="powerup-markup">'+b.substring(a)+"</span>";a<b.length&&c.html(e)}),$(p).each((c,b)=>{let a=$(b);a.attr("title").includes(L)&&a.hide()}),b.resolve(!0),b},a.bannerPowerUp=function(){if(!a.config.Powerups.bannerPU)return;let b=!1;$(p).each((d,c)=>{let a=$(c).attr("title");if(a.includes(L)){aP(a,L).find(a=>"color"==a[0])[1];let b=`POWERUP: DEPRECATED - ${L} has moved to Markdown tiles instead of Tags`;console.log(b),aS(b)}}),$(h).each((g,e)=>{let a=$(e);a.parents(f);let c=a.text();if(c.includes(L)){let d=aP(c,L).find(a=>"color"==a[0])[1];$(o).css("background",d),$(o).css("color",aM(d)),a.hide(),b=!0,aJ.PU_BANNER?aJ.PU_BANNER++:aJ.PU_BANNER=1}}),b?a.config.Powerups.debug&&console.log("Powerup: DEBUG - banner power-up found"):($(o).css("background",""),$(o).css("color",""))},a.colorPowerUp=function(){if(!a.config.Powerups.colorPU)return;let g="powerup-color-normal",b="powerup-color-warning";switch(a.config.Powerups.animateWarning){case"3 Pulses":b+="-blink threeBlink";break;case"Always":b+="-blink"}let c="powerup-color-critical";switch(a.config.Powerups.animateCritical){case"Always":c+="-blink";break;case"Never":break;default:c+="-blink threeBlink"}$(d).each((x,t)=>{let r=$(t),u=r.text(),l=r.parents(".grid-tile"),v=l.find(i);if(r.text().includes(H)){a.config.Powerups.debug&&console.log("Powerup: color power-up found"),aT(l,"PU_Color deprecated. Please use Data Explorer.");let m=aP(u,H),h=(m.find(a=>"base"==a[0])||[])[1]||"low",n=Number((m.find(a=>"warn"==a[0])||[])[1]),o=Number((m.find(a=>"crit"==a[0])||[])[1]),f=Number(l.find(e).text().replace(/,/g,"")),s=(m.find(a=>"color"==a[0])||[])[1],w=(m.find(a=>"nan"==a[0])||["nan","#b7b7b7"])[1],d="Border"==a.config.Powerups.colorPUTarget?l:v;if(d.length||(d=l.find(z),f=NaN),isNaN(n)||isNaN(o))void 0!==s&&d.css("color",s);else{if(d.removeClass("powerup-color-critical powerup-color-warning powerup-color-normal"),d.removeClass("powerup-color-critical-blink powerup-color-warning-blink threeBlink"),d.removeClass("powerup-color-nan"),isNaN(f))d.addClass("powerup-color-nan").css("color",w);else if("low"==h)f<n?d.addClass(g):f<o?d.addClass(b):d.addClass(c);else if("high"==h)f>n?d.addClass(g):f>o?d.addClass(b):d.addClass(c);else if("string"==typeof h&&h.startsWith("abs")){let p=Number((h.split(",")||["abs","0"])[1]);f>=p+o||f<=p-o?d.addClass(c):f>=p+n||f<=p-n?d.addClass(b):d.addClass(g)}let k=l.find(j);if(k.length){let q=Number(k.text().replace(/%/,""));k.removeClass("powerup-color-critical powerup-color-warning powerup-color-normal"),"low"==h?q>0?k.addClass("powerup-color-warning"):q<0&&k.addClass("powerup-color-normal"):"high"==h&&(q<0?k.addClass("powerup-color-warning"):q>0&&k.addClass("powerup-color-normal"))}}aJ.PU_COLOR?aJ.PU_COLOR++:aJ.PU_COLOR=1}}),$(h).each((e,c)=>{let a=$(c),b=a.text();if(a.parents(f),b.includes(H)){let d=(aP(b,H).find(a=>"color"==a[0])||[])[1];d&&a.find("h2, p").each((e,b)=>{let a=$(b),c=a.text();a.text().includes(H)&&a.text(c.replace(/!PU\(color\):[^ ]*/,"")),a.css("color",d)})}}),$(G).each((e,d)=>{let a=$(d),b=a.text();if(a.parents(f),b.includes(H)){let c=(aP(b,H).find(a=>"color"==a[0])||[])[1];c&&a.text(b.replace(/!PU\(color\):[^ ]*/,"")).css("color",c)}})},a.PUTopListColor=function(){$(d).each((k,g)=>{let b=$(g),h=b.text(),c=b.parents(".grid-tile");if(b.text().includes(ag)){a.config.Powerups.debug&&console.log("Powerup: toplist color power-up found"),aT(c,"PU_Toplist deprecated. Please use Data Explorer.");let d=aP(h,ag),i=((d.find(a=>"vals"==a[0])||[])[1]||".5,.7,.85,.94").split(",").map(a=>Number(a)),l=((d.find(a=>"colors"==a[0])||[])[1]||"#dc172a,#ef651f,#ffe11c,#6bcb8b,#2ab06f").split(",");if(!i.reduce((a,b)=>!1!==a&&b>=a&&b)){let e="Powerup: ERROR - toplist PU must have vals sorted ascending";return console.log(e),aS(e),!0}let f=c.find(x),j=f.children().first().children(),m=f.children().last().children();j.each((a,b)=>{var c;let d=$(b),e,f=(c=Number(d.text()),i.forEach((b,a)=>{c<b&&(!a||c>=i[a-1])?e=l[a]:c>=b&&a==i.length-1&&(e=l[a+1])}),e);m.eq(a).find(y).css("background-color",f)})}})},a.svgPowerUp=function(){if(!a.config.Powerups.svgPU)return;let d="powerup-svg-normal",b="powerup-svg-warning";switch(a.config.Powerups.animateWarning){case"3 Pulses":b+="-blink threeBlink";break;case"Always":b+="-blink"}let c="powerup-svg-critical";switch(a.config.Powerups.animateCritical){case"Always":c+="-blink";break;case"Never":break;default:c+="-blink threeBlink"}$(h).each((s,n)=>{let k=$(n),l=k.text(),g=k.parents(".grid-tile"),t,m;if(!l.includes(I))return;a.config.Powerups.debug&&console.log("Powerup: svg power-up found");let e=aP(l,I),f=(e.find(a=>"icon"==a[0])||["icon","abort"])[1];f=f.includes(",")?f.split(","):[f];let j=(e.find(a=>"link"==a[0])||[])[1],u=(e.find(a=>"color"==a[0])||[])[1],o=(e.find(a=>"base"==a[0])||[])[1],p=Number((e.find(a=>"warn"==a[0])||[])[1]),q=Number((e.find(a=>"crit"==a[0])||[])[1]),h=(e.find(a=>"tooltip"==a[0])||[])[1],i=(e.argstring.match(/url=([^ ]+)/)||[])[1];i&&(i=i.trim());let w={icon:f,link:j,base:o,warn:p,crit:q,url:i},r;void 0!=j&&(r=a.findLinkedVal(j,I));let x=f.length>1;f.forEach((e,g)=>{var f=a.SVGLib()+encodeURI(`${e}.svg`);fetch(f).then(a=>a.text()).then(f=>{(!x||x&&0===g)&&k.empty();let a=$(f).addClass("powerupSVG").attr("data-args",JSON.stringify(w)).appendTo(k);if(x&&a.addClass("powerup-svg-multi").addClass(`powerup-svg-multi-${g}`),a.removeClass("powerup-svg-critical powerup-svg-warning powerup-svg-normal"),a.removeClass("powerup-svg-critical-blink powerup-svg-warning-blink threeBlink"),a.removeClass("powerup-svg-nan"),isNaN(r))a.addClass("powerup-svg-nan");else if("low"==o)r<p?a.addClass(d):r<q?a.addClass(b):a.addClass(c);else if("high"==o)r>p?a.addClass(d):r>q?a.addClass(b):a.addClass(c);else if("string"==typeof o&&o.startsWith("abs")){let e=Number((o.split(",")||["abs","0"])[1]);r>=e+q||r<=e-q?$target.addClass(c):r>=e+p||r<=e-p?$target.addClass(b):$target.addClass(d)}else u&&a.css("fill",u);i&&(t=$("<a>").attr("href",i).insertBefore(a),i.startsWith("http")&&t.attr("target","_blank"),a.appendTo(t),void 0!==t&& void 0!==m&&(t.on("click",()=>{$(".powerupTooltip").remove()}),a.on("click",()=>{$(".powerupTooltip").remove()}),window.addEventListener("hashchange",()=>{setTimeout(()=>{let a=document.getElementsByClassName("powerupTooltip");for(;a[0];)a[0].parentNode.removeChild(a[0])},500)},{once:!0})))})}),g.find(v).hide(),h&&(h=h.replace(/_/g," "),(m=g.find(".powerupTooltip")).length||(m=$("<div>").addClass("powerupTooltip").html(`<span>${h}</span>`).appendTo(g),g.on("mouseover",()=>{let a=g.offset();m.appendTo("body").offset(a).addClass("powerupTooltipHover")}),g.on("mouseout click",()=>{m.appendTo(g).removeClass("powerupTooltipHover")}))),aJ.PU_SVG?aJ.PU_SVG++:aJ.PU_SVG=1})},a.updateSVGPowerUp=function(){if(!a.config.Powerups.svgPU)return;let d="powerup-svg-normal",b="powerup-svg-warning";switch(a.config.Powerups.animateWarning){case"3 Pulses":b+="-blink threeBlink";break;case"Always":b+="-blink"}let c="powerup-svg-critical";switch(a.config.Powerups.animateCritical){case"Always":c+="-blink";break;case"Never":break;default:c+="-blink threeBlink"}$(h).each((l,j)=>{let i=$(j),k=i.parents(".grid-tile"),e=i.find("svg:first-of-type");if(e.length&&!e.hasClass("highcharts-root")){let g=e.attr("data-args")||"{}",f;if(void 0!=(g=JSON.parse(g)).link&&(f=a.findLinkedVal(g.link,"updateSVGPowerUp")),e.removeClass("powerup-svg-critical powerup-svg-warning powerup-svg-normal"),e.removeClass("powerup-svg-critical-blink powerup-svg-warning-blink threeBlink"),e.removeClass("powerup-svg-nan"),isNaN(f))e.addClass("powerup-svg-nan");else if("low"==g.base)f<g.warn?e.addClass(d):f<g.crit?e.addClass(b):e.addClass(c);else if("high"==g.base)f>g.warn?e.addClass(d):f>g.crit?e.addClass(b):e.addClass(c);else if("string"==typeof base&&base.startsWith("abs")){let h=Number((base.split(",")||["abs","0"])[1]);f>=h+crit||f<=h-crit?$target.addClass(c):f>=h+warn||f<=h-warn?$target.addClass(b):$target.addClass(d)}k.find(v).hide()}})},a.findLinkedElement=function(f,g=""){let a="!PU\\(link\\):"+f,i=new RegExp(a+"(?!\\w)"),b;if($(d).each((d,c)=>{let a=$(c);i.test(a.text())&&(b=a.parents(".grid-tile").find(e))}),"undefined"==typeof val&&$(h).each((d,c)=>{let a=$(c);i.test(a.text())&&(b=a.parents(".grid-tile").find(e))}),void 0!==b)return b;{let c=`Powerup: ERROR - ${g} - unable to match link: ${a}`;console.log(c),aS(c);return}},a.findLinkedVal=function(h,i=""){let c=a.findLinkedElement(h,i);if(void 0==c)return;let b=$(c).text();if(""==(b=b.trim()))return b;let d=Number(b);if(!isNaN(d))return d;if(b.match(/(?:\/)|(?:-.*-)|(?::)/)){let e=new Date(b);if(!isNaN(e.getTime()))return e.getTime()}let f=Number(b.replace(/,/g,""));if(!isNaN(f))return f;let g=Number(b.replace(/[^0-9.]/g,""));return isNaN(g)?b:g},a.findLinkedUnit=function(g,h=""){let d=a.findLinkedElement(g,h);if(void 0==d)return;let e=$(d),b=e.text().trim();if(""==b)return b;if(b.match(/[a-zA-Z]+/)){let c=b.match(/[0-9]+ *(.*) */);return c&&c.length>1?c[1]:""}{let f=e.siblings(":visible");return f.length?b=f.text().trim():""}},a.findLinkedTile=function(e,f=""){let a="!PU\\(link\\):"+e,g=new RegExp(a+"(?!\\w)"),b;if($(d).each((d,c)=>{let a=$(c);g.test(a.text())&&(b=a.parents(".grid-tile"))}),void 0!==b)return b;{let c=`Powerup: WARN - ${f} - unable to match link: ${a}`;console.log(c),aS(c);return}},a.findLinkedMarkdown=function(c,d=""){let e=K+c,a;if($(h).each((c,b)=>{$(b).text().includes(e)&&(a=b)}),void 0!==a)return a;{let b=`Powerup: ERROR - ${d} - unable to match markdown with link: ${e}`;console.log(b),aS(b);return}},a.sankeyPowerUp=function(){if(!a.config.Powerups.sankeyPU)return;let b=100;!function(c){function e(o,y){var p,q,h,r,s,t,i,u,v,z;let w=$(o),A=[],d=[],b=[],f=[],g=[],B=[],c=[],e={strings:[],doubles:[],longs:[],dates:[]};if(!function(c){if(c.length){if(Object.keys(c[0]).length<50){let a="POWERUP: WARN - Sankey - Missing columns. USQL should include 'SELECT useraction.*, usersession.* FROM usersession'";return console.log(a),aS(a),C(a),!1}}else{let b="POWERUP: WARN - Sankey - No sessions found via USQL.";return console.log(b),aS(b),C(b),!1}return!0}(d=($(p=w).children("div:first-of-type").children("div").each((b,c)=>{let a=$(c).find("span"),e=a.eq(0).text();a.length,void 0===A[b]&&(A[b]=[]),a.each(function(a,f){void 0===A[b][a]&&(A[b][a]=[]),void 0===d[a]&&(d[a]={});let g=$(f).text(),c=aR(g,e);A[b][a]=c,d[a][e]=c})}),d.shift(),d)))return!1;let j,k,l,m;f=(h=b=(j=[],(q=d).forEach((b,d)=>{let c=[];b["useraction.name"].forEach((a,d)=>{c.push({name:a,app:b["useraction.application"][d],errors:Number(b.totalErrorCount)})});let a=c.filter(a=>"[]"!==a.name&&""!==a.name);"2"==y.convHack&&(a.unshift({name:"START",app:""}),"true"==b.hasCrash?a.push({name:"CRASH",app:""}):a.push({name:"END",app:""})),Array.isArray(y.filter)&&y.filter.forEach(c=>{let d;switch(c.filter){case"touple":void 0!==c.from&& void 0!==c.to&&(d=a.findIndex((a,b,d)=>a.name===c.from&&(void 0===c.fromApp||c.fromApp===a.app)&&(void 0===c.toApp||c.fromApp===a.app)&&d.length>b+1&&d[b+1].name===c.to));break;case"nottouple":void 0!==c.from&& void 0!==c.to&&a.findIndex((a,b,d)=>a.name===c.from&&(void 0===c.fromApp||c.fromApp===a.app)&&(void 0===c.toApp||c.fromApp===a.app)&&d.length>b+1&&d[b+1].name===c.to)> -1&&(a=[]);break;case"prop":void 0!==c.type&& void 0!==c.key&& void 0!==c.val&&"string"===c.type&&(d=b["useraction.stringProperties"].flat().findIndex((a,b,d)=>a.key===c.key&&a.value===c.val));break;case"app":void 0!==c.app&&(d=a.findIndex((a,b,d)=>a.app===c.app));break;case"errors":!0===c.errors&&(d=a.findIndex((a,b,c)=>a.errors>0));break;case"crashgroup":void 0!==c.crashgroupid&&(d=b.crashGroupId===c.crashgroupid?0:-1);break;case"exclude":Array.isArray(c.exclude)&&c.exclude.length&&c.exclude.forEach(b=>{a=a.filter(a=>!a.name.includes(b))});break;case"includeonly":Array.isArray(c.include)&&c.include.length&&(a=a.filter(a=>["START","END","CRASH"].includes(a.name)||c.include.findIndex(b=>a.name.includes(b))> -1));break;case"action":c.action&&c.action.length&&(d=a.findIndex((a,b,d)=>a.name===c.action&&(void 0===c.app||c.app===a.app)));break;case"notaction":c.action&&c.action.length&&(a.findIndex((a,b,d)=>a.name===c.action)&&(void 0===c.aapp||c.app===x.app))> -1&&(a=[])}d<0&&(a=[])}),a.length&&(b.filtered=a.map(a=>a.name),b.filteredApp=a.map(a=>a.app),j.push(b))}),j),k=[],h.forEach(c=>{let d=[];if(!Array.isArray(c.filtered))return!1;for(let b=0;b<c.filtered.length-1;b++){let a={from:c.filtered[b],fromApp:c.filteredApp[b],to:c.filtered[b+1],toApp:c.filteredApp[b+1]};if(a.from===a.to)continue;"true"==y.convHack&&0===b&&(a.from="Start: "+a.from),"true"==y.convHack&&b+1===filtered.length-1&&(a.to="End: "+a.to);let e=k.findIndex(b=>b.from===a.from&&b.to===a.to&&b.fromApp===a.fromApp&&b.toApp===a.toApp);e<0?(a.weight=0,a.crashes=0,k.push(a)):a=k[e],a.weight++,"true"==c.hasCrash&&!d.includes(a)&&a.crashes++,d.includes(a)||d.push(a)}}),k),g=(l=[],(r=b).forEach(d=>{let c=d["useraction.matchingConversionGoals"];if(!Array.isArray(c))return!1;for(let b=0;b<c.length;b++)if(""!=c[b]){let f=d["useraction.name"][b],e=l.findIndex(a=>a.actionName==f);e<0?l.push({actionName:f,count:1,svg:`<img src='${a.SVGLib()+"finishflag.svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'>`,goalName:"["==c[b].substring(0,1)&&"]"==c[b].substr(-1)?c[b].substr(1,c[b].length-2).trim():c[b].trim()}):l[e].count++}}),l),c=(m=[],(s=b).forEach(b=>{let d=b["useraction.apdexCategory"];if(!Array.isArray(d))return!1;for(let a=0;a<d.length;a++){let e=d[a];if(""!==e){let f=b["useraction.name"][a],g=b["useraction.application"][a],h=b["useraction.internalApplicationId"][a],i=b["useraction.internalKeyUserActionId"][a],c=m.findIndex(a=>a.actionName==f&&a.app==g);if(c<0){let j={actionName:f,satisfied:0,tolerating:0,frustrated:0,app:g,appid:h,kuaid:i};c=m.length,m.push(j)}switch(e){case"SATISFIED":m[c].satisfied++;break;case"TOLERATING":m[c].tolerating++;break;case"FRUSTRATED":m[c].frustrated++}}}}),m),t=c,i=b,i.forEach(e=>{let d=e["useraction.isEntryAction"];if(!Array.isArray(d))return!1;for(let c=0;c<d.length;c++){let f=d[c];if("true"===f|| !0===f){let g=e["useraction.name"][c],b=t.findIndex(a=>a.actionName==g);b> -1&&(t[b].entryAction?t[b].entryAction++:t[b].entryAction=1,t[b].entryActionSVG=`<img src='${a.SVGLib()+"entry.svg"}'  onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'>`)}}}),function(c,b){b.forEach(f=>{let e=f["useraction.isExitAction"];if(!Array.isArray(e))return!1;for(let d=0;d<e.length;d++){let g=e[d];if("true"===g|| !0===g){let h=f["useraction.name"][d],b=c.findIndex(a=>a.actionName==h);b> -1&&(c[b].exitAction?c[b].exitAction++:c[b].exitAction=1,c[b].exitActionSVG=`<img src='${a.SVGLib()+"exit.svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'>`)}}})}(c,b),function(b,a){a.forEach(c=>{let a=c["useraction.stringProperties"];if(!Array.isArray(a))return!1;a.forEach((a,d)=>{a.forEach((a,i)=>{let f=c["useraction.name"][d],e=b.strings.findIndex(b=>b.actionName==f&&b.key==a.key&&b.val==a.value);if(e<0){let g={actionName:f,key:a.key,val:a.value,count:1};b.strings.push(g)}else{let h=b.strings[e];h.count++}})})})}(e,b),function(b,a){a.forEach(c=>{let a=c["useraction.doubleProperties"];if(!Array.isArray(a))return!1;a.forEach((a,d)=>{a.forEach((a,j)=>{let h=c["useraction.name"][d],e=b.doubles.findIndex(b=>b.actionName==h&&b.key==a.key),f=Number(a.value);if(e<0){let i={actionName:h,key:a.key,sum:f,count:1};b.doubles.push(i)}else{let g=b.doubles[e];g.count++,g.sum+=f}})})})}(e,b),function(b,a){a.forEach(c=>{let a=c["useraction.longProperties"];if(!Array.isArray(a))return!1;a.forEach((a,d)=>{a.forEach((a,j)=>{let h=c["useraction.name"][d],e=b.longs.findIndex(b=>b.actionName==h&&b.key==a.key),f=Number(a.value);if(e<0){let i={actionName:h,key:a.key,sum:f,count:1};b.longs.push(i)}else{let g=b.longs[e];g.count++,g.sum+=f}})})})}(e,b),function(b,a){a.forEach(c=>{let a=c["useraction.dateProperties"];if(!Array.isArray(a))return!1;a.forEach((a,d)=>{a.forEach((a,i)=>{let f=c["useraction.name"][d],e=b.dates.findIndex(b=>b.actionName==f&&b.key==a.key&&b.val==a.value);if(e<0){let g={actionName:f,key:a.key,val:a.value,count:1};b.dates.push(g)}else{let h=b.dates[e];h.count++}})})})}(e,b),function(b,a){a.forEach((e,g)=>{let d=e["useraction.duration"];if(!Array.isArray(d))return!1;for(let a=0;a<d.length;a++){let f=d[a];if(""!==f){let h=e["useraction.name"][a],c=b.findIndex(a=>a.actionName==h);c> -1&&(Array.isArray(b[c].durations)||(b[c].durations=[]),b[c].durations.push(f))}}})}(c,b),function(b,a){a.forEach((a,w)=>{if(a.hasOwnProperty("useraction.errorCount")){let k=a["useraction.errorCount"];if(!Array.isArray(k))return!1;for(let c=0;c<k.length;c++){let s=k[c];if(""!==s){let x=a["useraction.name"][c],d=b.findIndex(a=>a.actionName==x);if(d> -1){void 0===b[d].errors&&(b[d].errors=0);let l=Number(s);!isNaN(l)&&l>0&&(b[d].errors+=l)}}}}else{if(a.hasOwnProperty("useraction.requestErrorCount")){let m=a["useraction.requestErrorCount"];if(!Array.isArray(m))return!1;for(let e=0;e<m.length;e++){let t=m[e];if(""!==t){let y=a["useraction.name"][e],f=b.findIndex(a=>a.actionName==y);if(f> -1){void 0===b[f].errors&&(b[f].errors=0);let n=Number(t);!isNaN(n)&&n>0&&(b[f].errors+=n)}}}}if(a.hasOwnProperty("useraction.customErrorCount")){let o=a["useraction.customErrorCount"];if(!Array.isArray(o))return!1;for(let g=0;g<o.length;g++){let u=o[g];if(""!==u){let z=a["useraction.name"][g],h=b.findIndex(a=>a.actionName==z);if(h> -1){void 0===b[h].errors&&(b[h].errors=0);let p=Number(u);!isNaN(p)&&p>0&&(b[h].errors+=p)}}}}if(a.hasOwnProperty("useraction.javaScriptErrorCount")){let q=a["useraction.javaScriptErrorCount"];if(!Array.isArray(q))return!1;for(let i=0;i<q.length;i++){let v=q[i];if(""!==v){let A=a["useraction.name"][i],j=b.findIndex(a=>a.actionName==A);if(j> -1){void 0===b[j].errors&&(b[j].errors=0);let r=Number(v);!isNaN(r)&&r>0&&(b[j].errors+=r)}}}}}})}(c,b),function(b,a){a.forEach((e,g)=>{let a=e["useraction.name"],f=e.hasCrash;if(!Array.isArray(a))return!1;for(let c=0;c<a.length;c++){let h=a[c],d=b.findIndex(a=>a.actionName==h);a.findIndex(a=>a==h)>=c&&d> -1&&(void 0===b[d].crashes&&(b[d].crashes=0),"true"===f&&b[d].crashes++)}})}(c,b),function(b){b.forEach(b=>{b.satisfied>=Math.max(b.tolerating,b.frustrated)?b.name="satisfied":b.tolerating>=Math.max(b.satisfied,b.frustrated)?(b.svg=`<img src="${a.SVGLib()+"smiley-neutral-2.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-yellow'></div>`,b.name="tolerating"):b.frustrated>=Math.max(b.tolerating,b.satisfied)?(b.svg=`<img src="${a.SVGLib()+"smiley-unhappy-2.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-red'></div>`,b.name="frustrated"):b.svg="",b.count=b.satisfied+b.tolerating+b.frustrated})}(c),function(a,b){a.forEach(a=>{b.findIndex(b=>b.actionName===a.actionName)> -1?a.goal=!0:a.goal=!1})}(c,g),function(b){let a=window.location.hash.split(";").map(a=>a.split("=")),c=(a.find(a=>"gtf"===a[0])||["gtf","-2h"])[1],d=(a.find(a=>"gf"===a[0])||["gf","all"])[1];b.forEach(a=>{let b="";b=a.appid&&a.appid.length&&"null"!==a.appid?a.kuaid&&a.kuaid.length&&"null"!==a.kuaid?`#uemapplications/uemuseractionmetrics;uemuserActionId=${a.kuaid};uemapplicationId=${a.appid};meid=${a.kuaid};gtf=${c};gf=${d}`:`#uemapplications/performanceanalysis;uemapplicationId=${a.appid};visiblepart=action;gtf=${c};gf=${d}`:"",a.drilldown=b})}(c),f=(u=f).sort((a,b)=>b.weight-a.weight);let n,x=(n=[],(v=d).forEach(b=>{let d=b["useraction.name"];if(!Array.isArray(d))return!1;for(let a=0;a<d.length;a++)if(0>c.findIndex(c=>c.actionName===b["useraction.name"][a]&&c.app===b["useraction.application"][a])){let e=n.findIndex(c=>c.actionName===b["useraction.name"][a]&&c.app===b["useraction.application"][a]);e<0?n.push({actionName:b["useraction.name"][a],app:b["useraction.application"][a],count:1}):n[e].count+=1}}),n);return{touples:f,goals:g,apdexList:c,UAPs:e,rows:b.length,filteredTable:b,crashes:b.filter(a=>"true"==a.hasCrash).length,applicationTypes:[...new Set(b.map(a=>a.applicationType))],totalSessions:d.length,filteredOut:x};function C(a){$container=$(y.container);let b=`<h2>${a}</h2>`;$container.html(b)}}function g(d,j,i,k=20){if(!d)return!1;let l=!1;(d.applicationTypes.includes("MOBILE_APPLICATION")||d.applicationTypes.includes("CUSTOM_APPLICATION"))&&(l=!0),d.slicedTouples=d.touples.slice(0,k),d.actionsShown=[...new Set(d.slicedTouples.map(a=>[a.from,a.to]).flat().filter(a=>"START"!==a&&"END"!==a&&"CRASH"!==a))];let h={type:"sankey",title:{text:i.title},chart:{marginLeft:50,marginBottom:200,marginRight:150,marginTop:100},series:[{data:d.slicedTouples,type:"sankey",name:"UserActions",cursor:"crosshair",clip:!1,dataLabels:{enabled:!0,useHTML:!0,nodeFormat:"{point.display}",padding:0,color:"white"},nodes:[],tooltip:{nodeFormatter:function(){let a=this,b="";switch(a.id){case"START":let c=!1;a.linksFrom.forEach(a=>{"false"!==a.toNode.entryAction&& void 0!==a.toNode.entryAction&&a.toNode.entryAction||(c=!0)}),b=`<div class="powerup-sankey-tooltip"><b>${a.name}</b><br>UserActions in sample: ${a.sum}<br><br><small><i>Artificial node to group Entry actions</i></small>`+(c?"<br><small><i>Note: due to filtering, not all linked actions are Entry actions.</i></small>":"")+"</div>";break;case"END":let d=!1;a.linksTo.forEach(a=>{"false"!==a.fromNode.exitAction&& void 0!==a.fromNode.exitAction&&a.fromNode.exitAction||(d=!0)}),b=`<div class="powerup-sankey-tooltip"><b>${a.name}</b><br>UserActions in sample: ${a.apdexSum}<br><br><small><i>Artificial node to group Exit actions</i></small>`+(d?"<br><small><i>Note: due to filtering, not all linked actions are Exit actions.</i></small>":"")+"</div>";break;case"CRASH":b=`<div class="powerup-sankey-tooltip"><b>${a.name}</b><br>UserActions in sample: ${a.apdexSum}<br><br><small><i>Artificial node to group Crash actions</i></small></div>`;break;default:b=`<div class="powerup-sankey-tooltip">
                            <b>${a.name}</b><br>
                            App: ${a.app}<br>
                            UserActions in sample: ${a.apdexSum} `+(a.selfActions?"<sup>*</sup>":"")+`<br>
                            <u>Apdex</u><br>
                            &nbsp;&nbsp; Satisfied: ${a.apdexSatisfied}<br>
                            &nbsp;&nbsp; Tolerating: ${a.apdexTolerating}<br>
                            &nbsp;&nbsp; Frustrated: ${a.apdexFrustrated}<br>
                            Errors: ${a.errors}<br>
                            Avg Duration: ${a.avgDuration}ms<br>
                            Is entry action: ${a.entryAction}<br>
                            Is exit action: ${a.exitAction}<br>
                            Goal: ${a.conversionGoal}<br>`+(i.kpi?`${m(i.kpi)}: ${a[i.kpi]}<br>`:"")+(a.selfActions?`<br><sup>*</sup> <small><i>includes ${a.selfActions} repeated actions</i></small>`:"")+"</div>"}return b.trim()},pointFormatter:function(){let a=this;if(!$(a.graphic.element).is(":hover")){console.log("POWERUP: ERROR - Sankey - pointFormatter run on non-hover object"),a.series.chart.tooltip.hide();return}return"START"===a.fromNode.name&&"END"===a.toNode.name?`<div class="powerup-sankey-tooltip">
                        ${a.fromNode.name} → ${a.toNode.name}: <b>${a.weight}</b><br/>
                        <small><i>INFO: consider updating your USQL where clause instead<br/> to get more meaningful user actions.</i></small>
                        </div>`:`<div class="powerup-sankey-tooltip">
                        ${a.fromNode.name} → ${a.toNode.name}: <b>${a.weight}</b><br/>`+(l?`Crashes: ${a.crashes}<br/>`:"")+"</div>".trim()},headerFormat:""}}],tooltip:{useHTML:!0,outside:!0,borderWidth:0,backgroundColor:"none",shadow:!1,className:"powerup-sankey-tooltip"},exporting:{enabled:!0,fallbackToExportServer:!0,libURL:a.POWERUP_EXT_URL+"3rdParty/Highcharts/lib",buttons:{contextButton:{menuItems:["downloadSVG","downloadPDF","separator","printChart"],x:-40}}}};function m(a){return!!a&&a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()}if("2"==i.convHack){let f={id:"START",display:"Start ...",color:"#b7b7b7",dataLabels:{rotation:270,style:{textOutline:!1},className:"powerupSankeyNodeTextLabel"}};f.apdexSum=d.touples.filter(a=>a.to===f.id).reduce((a,b)=>a+b.weight,0),h.series[0].nodes.push(f),(f={id:"END",display:"... End",color:"#b7b7b7",dataLabels:{rotation:270,style:{textOutline:!1},className:"powerupSankeyNodeTextLabel"}}).apdexSum=d.touples.filter(a=>a.to===f.id).reduce((a,b)=>a+b.weight,0),h.series[0].nodes.push(f),d.touples.filter(a=>a.crashes).length&&((f={id:"CRASH",display:"CRASH",color:as,dataLabels:{rotation:270,style:{textOutline:!1},className:"powerupSankeyNodeTextLabel"}}).apdexSum=d.touples.filter(a=>a.to===f.id).reduce((a,b)=>a+b.weight,0),h.series[0].nodes.push(f))}return d.apdexList.forEach(a=>{let b={id:a.actionName,app:a.app,apdex:a,apdexSatisfied:a.satisfied.toString(),apdexTolerating:a.tolerating.toString(),apdexFrustrated:a.frustrated.toString(),entryAction:a.entryAction?a.entryAction:0,exitAction:a.exitAction?a.exitAction:0,errors:a.errors,crashes:a.crashes};if(b.apdexSum=a.satisfied+a.tolerating+a.frustrated,b.toupleTotal=d.touples.filter(a=>a.to===b.id).reduce((a,b)=>a+b.weight,0),b.selfActions=b.apdexSum-b.toupleTotal,Array.isArray(a.durations)){let e=b.apdex.durations.map(a=>Number(a.replace(/[,ms]*/g,"")));e.reduce((a,b)=>Math.min(a,b)),e.reduce((a,b)=>Math.max(a,b));let k=e.reduce((a,b)=>a+b,0)/e.length;fmt=Intl.NumberFormat(void 0,{maximumFractionDigits:2}).format,b.avgDuration=fmt(k)}let c=d.goals.find(b=>b.actionName==a.actionName);void 0!==c?(b.goal=c,b.conversionGoal=c.goalName):b.conversionGoal="false";let g=navigator.language,j=d.UAPs.doubles.find(b=>b.actionName==a.actionName&&b.key==i.kpi),f={maximumFractionDigits:2};i.kpicurr&&i.kpicurr.length&&(f={style:"currency",currency:i.kpicurr}),void 0!==j?b[i.kpi]=Intl.NumberFormat(g,f).format(j.sum):b[i.kpi]=Intl.NumberFormat(g,f).format(0),b.display=(c?`<br>${c.svg}`:"")+(a.entryActionSVG?`<br>${a.entryActionSVG}`:"")+(a.exitActionSVG?`<br>${a.exitActionSVG}`:""),h.series[0].nodes.push(b)}),h.series[0].nodes.forEach(a=>{switch(i.colors){case"crashes":a.color=at,"CRASH"==a.id&&h.series[0].nodes.filter(a=>a.crashes).length>0&&(a.color=as);break;case"errors":["START","END","CRASH"].includes(a.id)?a.color=at:a.errors>10?a.color=as:a.errors>1?a.color=au:a.color=av;break;case"false":["START","END","CRASH"].includes(a.id)?a.color=at:a.color=null;break;default:if(void 0==a.apdex){a.color=at;return}"satisfied"==a.apdex.name?a.color=av:"tolerating"==a.apdex.name?a.color=au:"frustrated"==a.apdex.name?a.color=as:a.color=at}}),c.chart(j,h,c=>{let f=$(j);if(f.children("div:first-of-type").css("margin-top","15px").css("left","0px"),c.limit=k=Math.min(k,d.touples.length),c.limit>2&&c.renderer.button("-",10,5).attr({zIndex:1100}).on("click",function(a){a.stopPropagation();let b=Math.max(Math.round(.5*c.limit),2);if(c&& void 0!==c.destroy)try{c.destroy()}catch(e){console.warn("POWERUP: exception on chart.destroy on click",e)}else c=null;g(d,j,i,b)}).add(),c.limit<b&&c.limit<d.touples.length&&c.renderer.button("+",40,5).attr({zIndex:1100}).on("click",function(e){e.stopPropagation();let a=Math.min(2*c.limit,d.touples.length);if(a=Math.min(a,b),c&& void 0!==c.destroy)try{c.destroy()}catch(f){console.warn("POWERUP: exception on chart.destroy on click",f)}else c=null;g(d,j,i,a)}).add(),c.renderer.text(`Showing top ${k} of <a href="javascript:" class="powerupFilterProp">${d.touples.length}</a> links`,70,25).add().on("click",function(n){let c=window.location.hash.split(";").map(a=>a.split("="));(c.find(a=>"gtf"===a[0])||["gtf","-2h"])[1],(c.find(a=>"gf"===a[0])||["gf","all"])[1];let o=!1,f=`<div><h3>Chart is showing ${d.slicedTouples.length} of ${d.touples.length} total links between actions within ${d.filteredTable.length} sessions:</h3><p>The Sankey PowerUp visualization limits the amount of useractions shown in order to make the chart more readable. This does not mean data is missing, only that certain useraction-to-useraction links are not visualized. For example, if your typical user journey is A -> B -> C. If a few users actual journey was A -> B -> D -> C, D may not be visualized by default. Those users' counts would still be present in the totals for nodes A, B, and C; however if you look at the link B -> C you'll notice both visually and numerically, that it is smaller than the total for C. If you wish to dig deeper into less frequent journey paths, click the plus sign at the top left to include more actions. You may also sometimes notice that even with all links shown, the sum of the links going into a node, does not equal the total shown. This is due to "repeated actions", for example: A -> B -> B -> B -> C. In that example, you would see a disclaimer at the bottom of the tooltip for B, which says "* includes 2 repeated actions." These are not visualized as they do not add informational value.</p>`;f+=`<h3>Full list of links between user actions within ${d.filteredTable.length} sessions:</h3></div>`;let b=$("<div>").addClass("powerupSankeyDetailPopup").html(f).appendTo(j),l=$('<table class="powerupLinkPopup">').appendTo(b),p=$(`<tr class="powerupColHeaders">
                            <th>&nbsp;</th>
                            <th>From App</th>
                            <th>From Action</th>
                            <th>To App</th>
                            <th>To Action</th>
                            <th>Count</th>
                            <th class="powerupSankeyPopupTooltip">
                                <img src='${a.SVGLib()+"and-not.svg"}' alt="Sessions not including link" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'>
                                <span class="powerupSankeyPopupTooltipText">Sessions not including link</span>
                            </th>
                            <th class="powerupSankeyPopupTooltip">
                                <img src='${a.SVGLib()+"and.svg"}' alt="Sessions including link" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'>
                                <span class="powerupSankeyPopupTooltipText">Sessions including link</span>
                            </th>
                            </tr>
                        `).appendTo(l).find("th").length;function h(b,e,c){function f(d){o=!0;let a=$(d.target),e=a.is(":checked"),b=a.data();if(!Object.keys(b).length)return!1;if(Array.isArray(i.filter)||(i.filter=[]),e)i.filter.push(b);else{let c=i.filter.findIndex(a=>JSON.stringify(a)===JSON.stringify(b));c> -1&&i.filter.splice(c,1)}}$(`<tr class="powerupSubHeader"><th colspan="${p}">${b}</th></tr>`).appendTo(l),c.forEach(b=>{let g=(d.apdexList.find(a=>a.app===b.fromApp&&a.actionName===b.from)||{drilldown:null}).drilldown,h=(d.apdexList.find(a=>a.app===b.toApp&&a.actionName===b.to)||{drilldown:null}).drilldown,c=$("<tr></tr>");$(`<td><img src='${a.SVGLib()+e+".svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'></td>`).appendTo(c),$(`<td>${b.fromApp}</td>`).appendTo(c),$("<td>"+(g?`<a href="${g}">${b.from}</a>`:`${b.from}`)+"</td>").appendTo(c),$(`<td>${b.toApp}</td>`).appendTo(c),$("<td>"+(h?`<a href="${h}">${b.to}</a>`:`${b.to}`)+"</td>").appendTo(c),$(`<td>${b.weight}</td>`).appendTo(c);let j=$("<td></td>").appendTo(c);$('<input type="checkbox">').data("filter","nottouple").data("from",b.from).data("to",b.to).data("fromApp",b.fromApp).data("toApp",b.toApp).appendTo(j);let k=$("<td></td>").appendTo(c);$('<input type="checkbox">').data("filter","touple").data("from",b.from).data("to",b.to).data("fromApp",b.fromApp).data("toApp",b.toApp).appendTo(k),c.find('input[type="checkbox"]').each((b,a)=>(function(b){let a=$(b),c=a.data();if(!Object.keys(c).length)return!1;Array.isArray(i.filter)||(i.filter=[]),i.filter.findIndex(a=>JSON.stringify(a)===JSON.stringify(c))> -1?a.prop("checked",!0):a.prop("checked",!1),a.on("change",f).on("click",function(a){a.stopPropagation()})})(a)),c.appendTo(l)})}h("Links shown:","overview",d.slicedTouples.sort((a,b)=>b.weight-a.weight)),h("Links not shown:","dont-watch",d.touples.filter(a=>0>d.slicedTouples.findIndex(b=>b.from===a.from&&b.fromApp===a.fromApp&&b.to===a.to&&b.toApp===a.toApp)).sort((a,b)=>b.weight-a.weight));let m=$('<div class="powerupSankeyButtonBar"></div>').appendTo(b);$('<div class="powerupSankeyButton">Filter</div>').appendTo(m).on("click",function(a){if($(a.target),a.stopPropagation(),b.remove(),o){let c=e(i.table,i);g(c,j,i,k)}}),$('<div class="powerupSankeyDisclaimer"><sup>*</sup> Note: counts based on a filtered sample. This may not include all matching crashes in total session population. <br>If you require deep analytics, please contact <a href="mailto:insights@dynatrace.com">Business Insights</a>.</div>').appendTo(b)}),c.renderer.text(`between ${d.actionsShown.length} of <a href="javascript:" class="powerupFilterProp">${d.apdexList.length}</a> actions`,70,40).add().on("click",function(n){let f=window.location.hash.split(";").map(a=>a.split("="));(f.find(a=>"gtf"===a[0])||["gtf","-2h"])[1],(f.find(a=>"gf"===a[0])||["gf","all"])[1];let o=!1,h=`<div><h3>Chart is showing ${d.actionsShown.length} of ${d.apdexList.length} total actions within ${d.filteredTable.length} sessions:</h3><p>The Sankey PowerUp visualization limits the amount of useractions shown in order to make the chart more readable. This does not mean data is missing, only that certain useraction-to-useraction links are not visualized. For example, if your typical user journey is A -> B -> C. If a few users actual journey was A -> B -> D -> C, D may not be visualized by default. Those users' counts would still be present in the totals for nodes A, B, and C; however if you look at the link B -> C you'll notice both visually and numerically, that it is smaller than the total for C. If you wish to dig deeper into less frequent journey paths, click the plus sign at the top left to include more actions. You may also sometimes notice that even with all links shown, the sum of the links going into a node, does not equal the total shown. This is due to "repeated actions", for example: A -> B -> B -> B -> C. In that example, you would see a disclaimer at the bottom of the tooltip for B, which says "* includes 2 repeated actions." These are not visualized as they do not add informational value.</p>`;h+=`<h3>Full list of user actions within ${d.filteredTable.length} sessions:</h3></div>`;let c=$("<div>").addClass("powerupSankeyDetailPopup").html(h).appendTo(j),l=$('<table class="powerupActionPopup">').appendTo(c),p=$(`<tr class="powerupColHeaders">
                            <th>&nbsp;</th>
                            <th>App</th>
                            <th>Action name</th>
                            <th>Count</th>
                            <th class="powerupSankeyPopupTooltip">
                                <img src='${a.SVGLib()+"dont-watch.svg"}' alt="Hide Action" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'>
                                <span class="powerupSankeyPopupTooltipText">Hide Action</span>
                            </th>
                            <th class="powerupSankeyPopupTooltip">
                                <img src='${a.SVGLib()+"and-not.svg"}' alt="Sessions not including action" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'>
                                <span class="powerupSankeyPopupTooltipText">Filter sessions not including action</span>
                            </th>
                            <th class="powerupSankeyPopupTooltip">
                                <img src='${a.SVGLib()+"and.svg"}' alt="Sessions including action" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'>
                                <span class="powerupSankeyPopupTooltipText">Filter sessions including action</span>
                            </th>
                            </tr>
                        `).appendTo(l).find("th").length;function b(b,d,c){function e(d){o=!0;let a=$(d.target),e=a.is(":checked"),b=a.data();if(!Object.keys(b).length)return!1;if(Array.isArray(i.filter)||(i.filter=[]),e)i.filter.push(b);else{let c=i.filter.findIndex(a=>JSON.stringify(a)===JSON.stringify(b));c> -1&&i.filter.splice(c,1)}}$(`<tr class="powerupSubHeader"><th colspan="${p}">${b}</th></tr>`).appendTo(l),c.forEach(b=>{let c=$("<tr></tr>");$(`<td><img src='${a.SVGLib()+d+".svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'></td>`).appendTo(c),$(`<td>${b.app}</td>`).appendTo(c),$(`<td><a href="${b.drilldown}">${b.actionName}</a></td>`).appendTo(c),$(`<td>${b.count}</td>`).appendTo(c);let f=$("<td></td>").appendTo(c);$('<input type="checkbox">').data("exclude",[b.actionName]).data("filter","exclude").appendTo(f);let g=$("<td></td>").appendTo(c);$('<input type="checkbox">').data("action",b.actionName).data("app",b.app).data("filter","notaction").appendTo(g);let h=$("<td></td>").appendTo(c);$('<input type="checkbox">').data("action",b.actionName).data("app",b.app).data("filter","action").appendTo(h),c.find('input[type="checkbox"]').each((b,a)=>(function(b){let a=$(b),c=a.data();if(!Object.keys(c).length)return!1;Array.isArray(i.filter)||(i.filter=[]),i.filter.findIndex(a=>JSON.stringify(a)===JSON.stringify(c))> -1?a.prop("checked",!0):a.prop("checked",!1),a.on("change",e).on("click",function(a){a.stopPropagation()})})(a)),c.appendTo(l)})}b("Actions with Conversion Goals:","overview",d.apdexList.filter(a=>a.goal).filter(a=>d.actionsShown.includes(a.actionName)).sort((a,b)=>b.count-a.count)),b("Actions flagged as Entry Actions:","overview",d.apdexList.filter(a=>a.entryAction).filter(a=>d.actionsShown.includes(a.actionName)).sort((a,b)=>b.count-a.count)),b("Actions flagged as Exit Actions:","overview",d.apdexList.filter(a=>a.exitAction).filter(a=>d.actionsShown.includes(a.actionName)).sort((a,b)=>b.count-a.count)),b("All other Actions:","overview",d.apdexList.filter(a=>!a.goal&&!a.entryAction&&!a.exitAction).filter(a=>d.actionsShown.includes(a.actionName)).sort((a,b)=>b.count-a.count)),b("Actions not currently shown:","dont-watch",d.apdexList.filter(a=>!d.actionsShown.includes(a.actionName)).sort((a,b)=>b.count-a.count)),b("Actions in sample but not in filtered sessions:","dont-watch",d.filteredOut.sort((a,b)=>b.count-a.count));let m=$('<div class="powerupSankeyButtonBar"></div>').appendTo(c);$('<div class="powerupSankeyButton">Filter</div>').appendTo(m).on("click",function(a){if($(a.target),c.remove(),o){let b=e(i.table,i);g(b,j,i,k)}}),$('<div class="powerupSankeyDisclaimer"><sup>*</sup> Note: counts based on a filtered sample. This may not include all matching crashes in total session population. <br>If you require deep analytics, please contact <a href="mailto:insights@dynatrace.com">Business Insights</a>.</div>').appendTo(c)}),c.renderer.text(`Showing <a href="javascript:" class="powerupFilterProp">${d.rows}</a> of ${d.totalSessions} sessions in USQL sample`,300,25).add().on("click",function(e){let c=window.location.hash.split(";").map(a=>a.split("=")),f=(c.find(a=>"gtf"===a[0])||["gtf","-2h"])[1],g=(c.find(a=>"gf"===a[0])||["gf","all"])[1],b="<div><h3>Session List <sup>*</sup></h3><table>";b+="<tr><th>SR</th><th>UX</th><th>Goal</th><th>UserId</th></tr>",d.filteredTable.forEach(c=>{switch(b+="<tr>","true"===c.hasSessionReplay?b+=`<td><img src="${a.SVGLib()+"replay.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-teal'></td>`:b+="<td></td>",c.userExperienceScore){case"SATISFIED":b+=`<td><img src="${a.SVGLib()+"smiley-happy-2.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-green'></td>`;break;case"TOLERATED":b+=`<td><img src="${a.SVGLib()+"smiley-neutral-2.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-yellow'></td>`;break;case"FRUSTRATED":b+=`<td><img src="${a.SVGLib()+"smiley-unhappy-2.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-red'></td>`;break;default:b+="<td></td>"}c["useraction.matchingConversionGoals"].filter(a=>""!=a).length?b+=`<td><img src='${a.SVGLib()+"finishflag.svg"}' onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-white'></td>`:b+="<td></td>";let d="null"!==c.userId?c.userId:"anonymous";b+=`<td><a href='/ui/user-sessions/query?sessionquery=SELECT%20*%20FROM%20usersession%20WHERE%20userSessionId%20%3D%20"${c.userSessionId}"&gtf=${f}&gf=${g}'>${d}</a></td>`,b+="</tr>"}),b+="</table></div><div>&nbsp;</div>",b+='<div class="powerupSankeyDisclaimer"><sup>*</sup> Note: session list is based on a filtered sample. This may not include all matching sessions in total session population. <br>If you require deep analytics, please contact <a href="mailto:insights@dynatrace.com">Business Insights</a>.</div>';let h=$("<div>").addClass("powerupSankeyDetailPopup").html(b).click(()=>{h.remove()}).appendTo(j)}),(d.applicationTypes.includes("MOBILE_APPLICATION")||d.applicationTypes.includes("CUSTOM_APPLICATION"))&&c.renderer.text(`with <a href="javascript:" class="powerupFilterProp">${d.crashes}</a> crashes`,300,40).add().on("click",function(g){let c=window.location.hash.split(";").map(a=>a.split("=")),h=(c.find(a=>"gtf"===a[0])||["gtf","-2h"])[1],i=(c.find(a=>"gf"===a[0])||["gf","all"])[1],e=[...new Set(d.filteredTable.filter(a=>"true"==a.hasCrash).map(a=>a.crashGroupId))],b=`<div><h3>${d.crashes} Crashes across ${e.length} crash groups:</h3><ul>`;e.forEach(e=>{let c=d.filteredTable.filter(a=>a.crashGroupId===e),f;c&&c[0]&&c[0]["useraction.internalApplicationId"]&&(f=c[0]["useraction.internalApplicationId"][0]),b+="<li>Crash Group: ",b+=`<a href="/ui/mrum/${f}/analyze-crashes-noes/${e}?gtf=${h}&gf=${i}">${e}</a><a href="javascript:" class="powerupFilterProp" data-crashgroupid="${e}" data-filter="crashgroup"><img src="${a.SVGLib()+"filter.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-purple'></a><br>`,b+="<table><tr><th>SR</th><th>UserId</th></tr>",c.sort((a,b)=>a.userId<b.userId?-1:1).forEach(c=>{b+="<tr>";let d="null"!==c.userId?c.userId:"anonymous";"true"===c.hasSessionReplay?b+=`<td><img src="${a.SVGLib()+"replay.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-teal'></td>`:b+="<td></td>",b+=`<td><a href='/ui/user-sessions/query?sessionquery=SELECT%20*%20FROM%20usersession%20WHERE%20userSessionId%20%3D%20"${c.userSessionId}"&gtf=${h}&gf=${i}'>${d}</a></td></tr>`}),b+="</table></li>"}),b+="</ul></div><div>&nbsp;</div>",b+='<div class="powerupSankeyDisclaimer"><sup>*</sup> Note: crash list is based on a filtered sample. This may not include all matching crashes in total session population. <br>If you require deep analytics, please contact <a href="mailto:insights@dynatrace.com">Business Insights</a>.</div>';let f=$("<div>").addClass("powerupSankeyDetailPopup").html(b).click(()=>{f.remove()}).appendTo(j);f.find(".powerupFilterProp").on("click",w)}),Array.isArray(i.filter)){let t=55,u=20;i.filter.forEach((a,d)=>{let b;switch(a.filter){case"touple":void 0!==a.from&& void 0!==a.to&&(b=`X - Sessions with ${a.from} -> ${a.to}`);break;case"nottouple":void 0!==a.from&& void 0!==a.to&&(b=`X - Sessions without ${a.from} -> ${a.to}`);break;case"prop":void 0!==a.type&& void 0!==a.key&& void 0!==a.val&&(b=`X - Sessions with (${a.type}) ${a.key}=${a.val}`);break;case"app":void 0!==a.app&&(b=`X - Sessions with app: ${a.app}`);break;case"errors":!0===a.errors&&(b="X - Sessions with errors");break;case"crashgroup":void 0!==a.crashgroupid&&(b=`X - Sessions with crashGroupId=${a.crashgroupid}`);break;case"exclude":Array.isArray(a.exclude)&&a.exclude.length&&(b=`X - Hide actions containing: ${a.exclude.join(",")}`);break;case"includeonly":Array.isArray(a.include)&&a.include.length&&(b=`X - Hide all actions except containing: ${a.include.join(",")}`);break;case"action":a.action&&a.action.length&&(b=`X - Sessions including action: ${a.action}`);break;case"notaction":a.action&&a.action.length&&(b=`X - Sessions not including action: ${a.action}`);break;default:b="X - "+JSON.stringify(a)}c.renderer.text(b,10,t).attr({zIndex:1100}).addClass("powerupRemoveFilter").on("click",function(a){if(a.stopPropagation(),Array.isArray(i.filter)&&i.filter.splice(d,1),c&& void 0!==c.destroy)try{c.destroy()}catch(b){console.warn("POWERUP: exception on chart.destroy on click",b)}else c=null;let f=e(i.table,i);g(f,j,i,20)}).add(),t+=u})}c.series[0].nodes.forEach(a=>{Array.isArray(i.filter)&&i.filter.filter(b=>b.action===a.id&&b.app===a.app).length&&$(a.graphic.element).css("stroke","#a972cc").css("stroke-width","3px")}),c.series[0].data.forEach(a=>{Array.isArray(i.filter)&&i.filter.filter(b=>b.from===a.from&&b.fromApp===a.fromApp&&b.to===a.to&&b.toApp===a.toApp).length&&$(a.graphic.element).css("stroke","#a972cc").css("stroke-width","3px")}),f.find(".highcharts-background").on("click",a=>{f.find(".powerupSankeyDetailPopup").remove(),a.stopPropagation()});let l;{let o=Math.round(.66*Number($(c.container).css("width").replace(/px/,""))),p=$(c.container).parent();l=$("<div>Color mode: </div>").addClass("powerupSankeyDropdown").css("left",`${o}px`).css("top","35px").appendTo(p);let h=$("<select>").addClass("sankeyColorPicker").appendTo(l);$('<option value="apdex">Apdex</option>').appendTo(h),$('<option value="errors">Errors</option>').appendTo(h),$('<option value="crashes">Crashes</option>').appendTo(h),$('<option value="false">Rainbow</option>').appendTo(h),h.val(i.colors),h.on("change",function(a){let b=$(a.target);i.colors=b.val(),g(d,j,i,c.limit)})}if(Array.isArray(i.filter)&&i.filter.length){let q=20,r=(Number($(c.container).css("width").replace(/px/,"")),Number(l.css("left").replace(/px/,""))+Number(l.css("width").replace(/px/,""))+q),s=$(c.container).parent(),m=$("<div></div>").addClass("powerupSankeySaveButton").css("left",`${r}px`).css("top","35px").css("height","35px").css("width","35px").appendTo(s);$(`<img src="${a.SVGLib()+"backup.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-teal'>`).appendTo(m),m.on("click",v)}async function v(e){let b=JSON.stringify(i.filter).replace(/\\"/g,'\\\\"'),c=`To save current filters:
                        1. Click OK below. 
                        JSON has already been copied to clipboard.
                        2. Edit dashboard.
                        3. Add Markdown tile with PU(link) syntax.
                        4. Paste JSON data on a seperate line.
                        5. Add 'flink' parameter to existing PU(sankey).`;try{await navigator.clipboard.writeText(b),console.log("POWERUP: DEBUG - clipboard success"),alert(c)}catch(f){console.error("POWERUP: ERROR - Failed to copy: ",f);try{let d=$("<textarea>").text(b).css("position","absolute").css("height","100px").css("width","100px").css("top","50%").css("right","0px").css("z-index","10000").appendTo("body"),a=d.get(0);a.focus(),a.select();let g=document.execCommand("copy");if(g)d.remove(),alert(c);else{let h="POWERUP: SANKEY - clipboard failure 1st attempt... retrying in 500ms";console.log(h),a.focus(),a.select(),setTimeout(()=>{a.focus(),a.select(),(g=document.execCommand("copy"))?(d.remove(),alert(c)):(h="POWERUP: SANKEY - clipboard failure 2nd attempt... Please manually copy-paste.",console.log(h),aS(h))},500)}}catch(j){console.log(`POWERUP: clipboard failure - ${j.message}`),console.log(document.activeElement)}}e.stopPropagation()}function w(d){let a=$(d.target);a.is("a")||(a=a.parents("a"));let b=a.data();if(!Object.keys(b).length)return!1;if(Array.isArray(i.filter)||(i.filter=[]),i.filter.push(b),c&& void 0!==c.destroy)try{c.destroy()}catch(f){console.warn("POWERUP: exception on chart.destroy on click",f)}else c=null;let h=e(i.table,i);g(h,j,i,k)}function n(n){let o=n.target,l=$(o),e;if(l.is(".highcharts-node"))e=c.series[0].nodes.find(a=>a.graphic.element===o);else{if(!l.parents(".highcharts-data-label").length)return!1;e=c.series[0].nodes.find(a=>a.dataLabel.div===l.parents(".highcharts-data-label")[0])}if(void 0===e|| void 0===e.apdex)return!1;let h=e.apdex.actionName,f=Intl.NumberFormat().format,p=f;if(i.kpicurr&&i.kpicurr.length){let q=navigator.language,r={style:"currency",currency:i.kpicurr};p=Intl.NumberFormat(q,r).format}let s=ar+encodeURIComponent(`SELECT * FROM usersession WHERE useraction.name LIKE "${h.replace(/"/g,'""')}"`),b=`<div><p><a href='${s}'><b>${h}</b></a><a href="javascript:" class="powerupFilterProp" data-filter="action"><img src="${a.SVGLib()+"filter.svg"}" onload="DashboardPowerups.SVGInject(this)" class='powerup-sankey-icon powerup-icon-lightpurple'></a>:</p><ul>`;if(b+=`<li>App: <a href="javascript:" class="powerupFilterProp" data-app="${e.app}" data-filter="app">${e.app}</a></li>`,Array.isArray(e.apdex.durations)){let g=e.apdex.durations.map(a=>Number(a.replace(/[,ms]*/g,""))),t=g.reduce((a,b)=>Math.min(a,b)),u=g.reduce((a,b)=>Math.max(a,b)),v=g.reduce((a,b)=>a+b,0),x=v/g.length;b+="<li>Action Duration (ms) <sup>*</sup>: <ul>",b+=`<li>min: ${f(t)}</li>`,b+=`<li>max: ${f(u)}</li>`,b+=`<li>avg: ${f(x)}</li>`,b+="</ul></li>"}if(void 0!==e.apdex.errors&&(b+=`<li>Errors: <a href="javascript:" class="powerupFilterProp" data-errors="true" data-filter="errors">${e.apdex.errors}</a></li>`),(d.UAPs.doubles.length||d.UAPs.longs.length||d.UAPs.strings.length||d.UAPs.dates.length)&&(b+="<li><u>User Action Properties</u></li>"),d.UAPs.doubles.length&&(b+="<li>Double Properties:<ul>",d.UAPs.doubles.filter(a=>a.actionName===h).sort((a,b)=>a.key.toLowerCase()<b.key.toLowerCase()?-1:a.key.toLowerCase()>b.key.toLowerCase()?1:a.sum-b.sum).forEach(a=>{let c=a.key===i.kpi?p:f,d=s+encodeURIComponent(` AND useraction.doubleProperties.${a.key} IS NOT NULL`);b+=`<li><a href="${d}">${a.key}</a> <sup>*</sup>: <ul><li>sum: ${c(a.sum)}</li><li>count: ${f(a.count)}</li><li>avg: ${c(a.sum/a.count)}</li></ul></li>`}),b+="</ul></li>"),d.UAPs.longs.length&&(b+="<li>Long Properties:<ul>",d.UAPs.longs.filter(a=>a.actionName===h).sort((a,b)=>a.key.toLowerCase()<b.key.toLowerCase()?-1:a.key.toLowerCase()>b.key.toLowerCase()?1:a.sum-b.sum).forEach(a=>{let c=s+encodeURIComponent(` AND useraction.longProperties.${a.key} IS NOT NULL`);b+=`<li><a href="${c}">${a.key}</a> <sup>*</sup>: <ul><li>sum: ${f(a.sum)}</li><li>count: ${f(a.count)}</li><li>avg: ${f(a.sum/a.count)}</li></ul></li>`}),b+="</ul></li>"),d.UAPs.strings.length){b+="<li>String Properties <sup>*</sup>:<ul>";let y,k="";d.UAPs.strings.filter(a=>a.actionName===h).sort((a,b)=>a.key.toLowerCase()<b.key.toLowerCase()?-1:a.key.toLowerCase()>b.key.toLowerCase()?1:b.count-a.count).forEach(a=>{if(a.key!==y){k.length&&(k+="</ul></li>"),b+=k;let c=s+encodeURIComponent(` AND useraction.stringProperties.${a.key} IS NOT NULL`);k=`<li><a href="${c}">${a.key}</a>:<ul>`}let d=s+encodeURIComponent(` AND useraction.stringProperties.${a.key} = "${a.val}"`);k+=`<li><a href="${d}">${a.val}</a> 
                                        (<a href="javascript:" class="powerupFilterProp" data-type="string" data-filter="prop"
                                        data-key="${a.key}" data-val="${a.val}">${a.count}</a>)
                                        </li>`,y=a.key}),k.length&&(k+="</ul></li>"),b+=k,b+="</ul></li>"}d.UAPs.dates.length&&(b+="<li>Date Properties <sup>*</sup>:<ul>",lastKey="",list="",d.UAPs.dates.filter(a=>a.actionName===h).sort((a,b)=>a.key.toLowerCase()<b.key.toLowerCase()?-1:a.key.toLowerCase()>b.key.toLowerCase()?1:b.count-a.count).forEach(a=>{if(a.key!==lastKey){list.length&&(list+="</ul></li>"),b+=list;let c=s+encodeURIComponent(` AND useraction.dateProperties.${a.key} IS NOT NULL`);list=`<li><a href="${c}">${a.key}</a>:<ul>`}let d=s+encodeURIComponent(` AND useraction.dateProperties.${a.key} = ${a.val}`);list+=`<li><a href="${d}">${a.val}</a> (${a.count})</li>`,lastKey=a.key}),list.length&&(list+="</ul></li>"),b+=list,b+="</ul></li>"),b+="</ul></div><div>&nbsp;</div>",b+='<div class="powerupSankeyDisclaimer"><sup>*</sup> Note: stats and counts are based on the filtered sample. Values may vary materially from total session population. <br>If you require deep analytics, please contact <a href="mailto:insights@dynatrace.com">Business Insights</a>.</div>';let m=$("<div>").addClass("powerupSankeyDetailPopup").html(b).click(()=>{m.remove()}).appendTo(j);m.find('a.powerupFilterProp[data-filter="action"]').data("action",h).data("app",e.app),m.find(".powerupFilterProp").on("click",w)}c.series[0].points.forEach(a=>{if("crashes"==i.colors){let b;b="CRASH"==a.toNode.id?a.crashes?as:at:a.crashes?au:at,a.update({color:b},!1,!1)}else a.update({color:a.toNode.color},!1,!1)}),c.setSize(void 0,void 0,!1),c.series[0].nodes.forEach(a=>{a.dataLabel&&a.dataLabel.element&&$(a.dataLabel.element).on("mousemove",a=>a.stopPropagation())}),f.find(".highcharts-plot-background").addClass("powerupPlotBackground"),f.find(".highcharts-node").click(n),f.find(".highcharts-data-label").click(n),f.find(".highcharts-link").click(function(b){let d=b.target,a;if($(d).is(".highcharts-link")&&(a=c.series[0].data.find(a=>a.graphic.element===d)),void 0===a)return!1;b.stopPropagation();let f={filter:"touple",from:a.from,to:a.to,fromApp:a.fromApp,toApp:a.toApp};if(Array.isArray(i.filter)||(i.filter=[]),i.filter.push(f),c&& void 0!==c.destroy)try{c.destroy()}catch(h){console.warn("POWERUP: exception on chart.destroy on click",h)}else c=null;let l=e(i.table,i);g(l,j,i,k)})})}c.seriesTypes.sankey.prototype.destroy=function(){this.data=[].concat(this.points,this.nodes),c.Series.prototype.destroy.call(this)},c.Point.prototype.destroyElements=function(){for(var b,a=this,d=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],e=d.length;e--;)a[b=d[e]]&&(a[b]=a[b].destroy());a.dataLabels&&(c.each(a.dataLabels,function(a){a.element&&a.destroy()}),delete a.dataLabels),a.connectors&&(c.each(a.connectors,function(a){a.element&&a.destroy()}),delete a.connectors)},$(d).each(function(G,y){let q=$(y),l=q.text();if(!l.includes(Q))return;let n=q.parents(f).find(m),z=l.split(Q)[0],c=aP(l,Q);if(c.length<1){let r="Powerup: ERROR - invalid argstring: "+c.argstring;return console.log(r),aS(r),!0}let A=c.find(a=>"link"==a[0])[1],s=(c.find(a=>"flink"==a[0])||[])[1],B=(c.find(a=>"kpi"==a[0])||[])[1],C=(c.find(a=>"kpicurr"==a[0])||[])[1],D=(c.find(a=>"convHack"==a[0])||[])[1]||"2",E=(c.find(a=>"colors"==a[0])||[])[1]||"apdex",i=(c.find(a=>"exclude"==a[0])||[])[1];i&&(i=i.split(","));let j=(c.find(a=>"include"==a[0])||[])[1];j&&(j=j.split(","));let d=Number((c.find(a=>"limit"==a[0])||[])[1]);isNaN(d)&&(d=20),d=Math.max(2,d),d=Math.min(d,b);let t=[],o=function(d){let b,a;if($(h).each(function(e,b){let c=$(b).text();c.includes(K)&&c.split(K)[1].includes(d)&&(a=b)}),a){let c=$(a).siblings("[data-highcharts-chart]").children(".highcharts-container");c.each((d,c)=>{let a=Highcharts.charts.filter(a=>void 0!==a).find(a=>a.container===c);b=$(c).parent().get(0),a&&a.destroy()}),!c.length&&($(a).hide(),b=$("<div>").addClass("powerupHighchartsContainer").insertAfter(a).get(0))}return b}(A);if(void 0===o){let u="Powerup: WARN - Sankey container is undefined.";return console.log(u),aS(u),!0}if(!n.length)return!0;if(s){let v=a.findLinkedMarkdown(s,Q);if(v){let p=$(v).text().split("\n").slice(1).join("\n").trim(),w;try{p&&(w=JSON.parse(p))&&(t=w)}catch(H){let x=`Powerup: WARN - Sankey filter JSON is invalid: ${p}`;console.log(x),aS(x)}}}let k={title:z,kpi:B,kpicurr:C,convHack:D,colors:E,table:n,container:o,filter:t};Array.isArray(i)&&i.length&&k.filter.push({filter:"exclude",exclude:i}),Array.isArray(j)&&j.length&&k.filter.push({filter:"includeonly",include:j});let F=e(n.get(0),k);g(F,o,k,d),$(".highcharts-exporting-group").addClass("powerupVisible"),aJ.PU_SANKEY?aJ.PU_SANKEY++:aJ.PU_SANKEY=1})}(Highcharts)},a.mapPowerUp=function(){if(!a.config.Powerups.worldmapPU)return;let b=function(b,a){a.disconnect(),setTimeout(()=>{transformMap(b,a)},50)};transformMap=function(u,m){if(!a.config.Powerups.worldmapPU)return;let b=aF.findIndex(a=>m===a),e=aG[b],d=$(e),c=d3.select(e),n=d.parents(k),g=d.parents(f),v=c.attr("width"),w=c.attr("height"),h=aH[b].keys,x=h[h.length-1],i=aH[b].normalTable,y=aH[b].color;aH[b].link;let o=aH[b].newTitle,p=Math.max(1,i.reduce((a,b)=>Math.max(b[x],a),0)),q=Math.max(1,i.reduce((a,b)=>Math.min(b[x],a),0)),z=d3.scaleLog().domain([q,p]),r=d3.zoom().scaleExtent([1,8]).on("zoom",function(){m.disconnect();let{transform:a}=d3.event,b=c.select("g[transform]");b.attr("transform",a),b.attr("stroke-width",1/a.k),m.observe(e,aE)});if(c.call(r),c.selectAll("path").on("click",function(b){let a=this.getBBox();d3.event.stopPropagation(),c.transition().duration(750).call(r.transform,d3.zoomIdentity.translate(v/2,w/2).scale(Math.min(8,.9/Math.max(a.width/v,a.height/w))).translate(-(a.x+a.width/2),-(a.y+a.height/2)),d3.mouse(c.node()))}),c.selectAll("path").on("mouseover",function(){if(!a.config.Powerups.worldmapPU)return;let b=g.find(".powerupMapTooltip"),e=$(this),j=e.attr("title"),k=e.attr("id").split("-")[1],c=h[h.length-1],d=i.find(a=>a.country==j),f;if(f=void 0!==d&& void 0!==d[c]?d[c].toLocaleString():"0",b.length){let l=k.toUpperCase().replace(/./g,a=>String.fromCodePoint(a.charCodeAt(0)+127397));b.find(".geoText").text(`Country: ${j} (${l})`),b.find(".valueText").text(`${c}: ${f}`)}}),c.on("click",function(){c.transition().duration(750).call(r.transform,d3.zoomIdentity,d3.zoomTransform(c.node()).invert([v/2,w/2]))}),d.find("path").css("fill",""),n.css("z-index",999),!g.find(".powerupMapTooltip").length){let j=$("<div>").addClass("powerupMapTooltip").appendTo(g);$("<div>").addClass("geoText").text("Country: ").appendTo(j),$("<div>").addClass("valueText").text("Value: ").appendTo(j)}d.find("path").each(function(f,e){let b=$(e),g=b.attr("title"),a=i.filter(a=>a.country==g);b.attr("data-data",JSON.stringify(a));let c=0;if(a.length&&a[0][x]){c=a[0][x];let d=d3.hsl(y);d.s=y.s*z(c),b.css("fill",d.toString())}});let s=d.parents(f).find(l),t=`World Map (${o})`;s.text(t),a.config.Powerups.debug&&console.log("Powerup: map powered-up"),m.observe(e,aE)},$(d).each((h,g)=>{let a=$(g),c=a.text(),i=a.parents(f);if(c.includes(J)){let j=a.text().split(J),d=aP(c,J),e=d.find(a=>"color"==a[0])[1]||"green";e=d3.hsl(e);let m=d.find(a=>"link"==a[0])[1];$(k).find("svg").each(function(o,k){if($(k).parents(f).find(l).text().includes(m)||null==m){let d=aG.findIndex(a=>a==k);if(d> -1){let a=aQ(i);a.color=e,a.link=m,a.newTitle=j[0].trim(),aH.splice(d,1,a);let n=aF[d];b(void 0,n)}else{let c=aQ(i);c.color=e,c.link=m,c.newTitle=j[0].trim(),aH.push(c);let h=new MutationObserver(b);h.observe(g,aE),aF.push(h),aG.push(k),b(void 0,h)}}}),aJ.PU_MAP?aJ.PU_MAP++:aJ.PU_MAP=1}})},a.PUHeatmap=function(h,n,j){if(!a.config.Powerups.heatmapPU||h.series.length<1||h.series[0].data.length<1)return;let b=aP(n,P),I=(b.find(a=>"txtColor"==a[0])||[])[1]||"#ffffff",e={},o=Number((b.find(a=>"ms"==a[0])||[])[1]||"86400000"),p=(b.find(a=>"fmt"==a[0])||[])[1]||"MM/DD",J=Number((b.find(a=>"scale"==a[0])||[])[1]||"1");if(b.argstring.includes("vals")){let q=e.dataClasses=[],i=((b.find(a=>"vals"==a[0])||[])[1]||".5,.7,.85,.94").split(",").map(a=>Number(a)),r=((b.find(a=>"names"==a[0])||[])[1]||"Unacceptable,Poor,Fair,Good,Excellent").split(","),s=((b.find(a=>"colors"==a[0])||[])[1]||"#dc172a,#ef651f,#ffe11c,#6bcb8b,#2ab06f").split(",");if(!i.reduce((a,b)=>!1!==a&&b>=a&&b)){let t="Powerup: ERROR - Heatmap PU must have vals sorted ascending";return console.log(t),aS(t),!1}for(let c=0;c<i.length;c++){let d={};0===c&&(d.to=i[c],d.name=r[c],d.color=s[c],q.push(d),d={}),d.from=i[c],d.name=r[c+1],d.color=s[c+1],c<i.length-1&&(d.to=i[c+1]),q.push(d)}}else{let u=(b.find(a=>"min"==a[0])||[])[1],v=(b.find(a=>"max"==a[0])||[])[1],w=(b.find(a=>"minColor"==a[0])||[])[1],x=(b.find(a=>"maxColor"==a[0])||[])[1];e={},void 0!==u&&(e.min=u),void 0!==v&&(e.max=v),void 0!==w&&(e.minColor=d3.rgb(w).toString()),void 0!==x&&(e.maxColor=d3.rgb(x).toString())}let l=h.container,y=$(l).parents(f);aT(y,"PU_Heatmap deprecated. Please use Data Explorer.");let m;if(void 0!==j){let z=Highcharts.charts.filter(a=>void 0!==a).find(a=>a.renderTo===j);z&&z.destroy(),m=$(j)}else j=(m=$("<div>").addClass("powerupHeatmap").insertAfter(l))[0],h.newContainer=j;let A=y.find(g);A.children().last().text().endsWith("more")&&A.children().last().text("ERROR: too many series");let k=[],E=[],B=[],F=[...new Set(h.series.map(a=>a.data).flat().map(a=>a.category))],G=new Map;function K(a,c){var d=a.series,b="y"===c;return d[b?"yAxis":"xAxis"].categories[a[b?"y":"x"]]}if(o&&p&&(F.forEach(a=>{if(!G.has(a)){let b;b=void 0!=dateFns?dateFns.format(parseInt(a/o)*o,p):a,G.set(a,b)}}),B=[...new Set(G.values())]),h.series.forEach((b,f)=>{if("column"!=b.type){let d="Powerup: ERROR - Please use a bar chart as a source for heatmap powerup.";console.log(d),aS(d);return}let e=b.name;if(A.length){let c=A.find(`svg[fill='${b.color}']`),a;1==c.length?a=c.parents(".gwt-HTML").text():c.length>1?a="ERROR: duplicate color in legend":c.length<1&&(a="ERROR: color not found in legend"),a.length&&(e=a)}E.push(e),b.data.forEach(a=>{if(o&&p)a.newCat=G.get(a.category),a.newCatIdx=B.findIndex(b=>b===a.newCat);else{let b=new Date(a.category);a.newCat=b.toLocaleDateString(),a.newCatIdx=B.findIndex(b=>b===a.newCat),a.newCatIdx<0&&(a.newCatIdx=B.length,B.push(a.newCat))}}),B.forEach((d,c)=>{let a=b.data.filter(a=>a.newCatIdx===c).reduce((a,d,e,b)=>{if(a+=d.y,e!==b.length-1)return a;{let c=b.filter(a=>null!==a.y).length;return c?a/c:NaN}},0);a*=J,k.push([c,f,a])})}),k=k.sort((a,b)=>a[0]===b[0]?a[1]-b[1]:a[0]-b[0]).filter(a=>void 0!=a&&3==a.length&& void 0!=a[0]&& void 0!=a[1]&& void 0!=a[2]),!Array.isArray(k)||!k.length){let C=`Powerup: WARN - ${P} - newData was empty!`;return console.log(C),aS(C),!1}let D={type:"heatmap",data:k,dataLabels:{...aC}};D.dataLabels.format="{point.value:.2f}";let H={type:"heatmap",series:[D],title:{text:n.split(P)[0]+" Heatmap"},credits:{enabled:!1},xAxis:{categories:B,reversed:!o||!p},yAxis:{categories:E,title:null,reversed:!0},tooltip:{enabled:!0,formatter:function(){return"Date:<b>"+K(this.point,"x")+"</b><br>App:<b>"+K(this.point,"y")+"</b><br>"+n.split(" ")[0]+":<b>"+this.point.value.toLocaleString(void 0,{maximumFractionDigits:2})+"</b>"}},colorAxis:e,exporting:{enabled:!0,fallbackToExportServer:!0,libURL:a.POWERUP_EXT_URL+"3rdParty/Highcharts/lib",buttons:{contextButton:{menuItems:["downloadSVG","downloadPDF","separator","downloadCSV","downloadXLS","printChart"]}}}};return $(l).hide(),m.html(""),Highcharts.chart(j,H,()=>{m.find("tspan").attr("stroke",""),m.find(".highcharts-data-label text").css("font-weight","").css("fill",I).css("font-size","10px"),m.find("rect.highcharts-point").attr("stroke","gray")}),$(".highcharts-exporting-group").addClass("powerupVisible"),!0},a.PUfunnel=function(){if(!a.config.Powerups.funnelPU)return;let b=new $.Deferred;if(!$(q).length)return!!aI&&(console.log("Powerup: DEBUG - D3MutexBlocking but no D3s. Clear it."),aI=!1,!1);if(aI)return console.log("Powerup: D3MutexBlocked Funnel Powerup"),!1;aI=!0,$.when(b).always(()=>{aI=!1});let c={chart:{curve:{enabled:!0,height:40},bottomPinch:1},block:{minHeight:100,dynamicHeight:!1,dynamicSlope:!1,barOverlay:!1,fill:{type:"gradient"}},label:{fill:"#fff",enabled:!1}};return $(q).each((u,m)=>{let e=$(m),i=e.parents(f),j=i.find(d),n=j.text();if(j.text().includes(R)){aT(i,"PU_Funnel deprecated due to low usage... Please create an issue on GitHub if still needed.");let g=aP(n,R),o=g.find(a=>"mode"==a[0])[1],v=Number((g.find(a=>"small"==a[0])||[])[1]),w=Number((g.find(a=>"big"==a[0])||[])[1]),p=(g.find(a=>"links"==a[0])||[])[1],k=$(a.findLinkedMarkdown(p,R)),q=k.text();k.hide();let r=/^(?:\d+=)(.*)/gm,x=Array.from(q.matchAll(r)).map(a=>a[1]);switch(o){case"slope":c.block.dynamicSlope=!0,c.block.dynamicHeight=!1,c.block.barOverlay=!1;break;case"bar":c.block.dynamicSlope=!1,c.block.dynamicHeight=!1,c.block.barOverlay=!0;break;default:c.block.dynamicSlope=!1,c.block.dynamicHeight=!0,c.block.barOverlay=!1}let l=e.children("div:nth-of-type(2)").children();l.length;let s=[];l.each((d,c)=>{let b=$(c),a={};a.abs=Number(b.find("div:first-of-type > span:nth-of-type(1)").text().replace(/[,]*/g,"")),a.percent=Number(b.find("div:first-of-type > span:nth-of-type(2)").text().replace(/[()%]*/g,"")),a.dPercent=Number(b.children("span:nth-of-type(1)").text().replace(/[()%]*/g,"")),a.dTime=b.children("span:nth-of-type(2)").text(),a.name=b.children("div:nth-of-type(2)").text(),a.label=a.name,a.value=a.abs,a.customFormattedValue=`
                        ${a.name}: <b>${a.abs}</b> (${a.percent}%)<br>
                        <small>${a.dPercent}% ${a.dTime}</small>
                        `.trim(),s.push(a)}),e.find("div:nth-of-type(1)").hide(),e.find("div:nth-of-type(2)").hide();let h=e.find(".powerupFunnelContainer");h.length||(h=$("<div>").addClass("powerupFunnelContainer").appendTo(e)),new D3Funnel(h[0]).draw(s,c);let y=5;function t(){if(!y)return b.resolve(!1),!1;let a=h.find("svg g").length;a==s.length?(s.forEach((a,c)=>{let d=h.find(`svg g:nth-of-type(${c+1}) path`),e=d.get(0).getBBox(),b=$("<div>").addClass("powerupFunnelLabel").html(a.customFormattedValue).appendTo(h),j=h.position().left+h.width()/2-b.width()/2,k=e.y+e.height/2-b.height()/2;b.css({top:k,left:j});let n=h.find(`svg linearGradient:nth-of-type(${c+1})`).eq(0),f;function g(g){let{r:d,g:e,b:f}=d3.color(g),a=-0.2,b=a<0?0:255,c=a<0?-1*a:a,h=16777216+(Math.round((b-d)*c)+d)*65536+(Math.round((b-e)*c)+e)*256+(Math.round((b-f)*c)+f);return`#${h.toString(16).slice(1)}`}let i=g(f=a.dPercent< -1*w?"#dc172a":a.dPercent>w?"#54c27d":a.dPercent< -1*v?"#f28289":a.dPercent>v?"#99dea8":"#898989");function l(a,b){n.find("stop").each((d,c)=>{switch(d){case 0:case 3:$(c).css("stop-color",b);break;default:$(c).css("stop-color",a)}})}l(f,i),0===c&&h.find("svg > path").eq(0).attr("fill",i);let m="#008cdb",o=g(m);d.add(b).hover(()=>{l(m,o)},()=>{l(f,i)}),"string"==typeof x[c]&&d.add(b).click(()=>{window.location.href=x[c]})}),console.log("Powerup: Funnel power up found"),aJ.PU_FUNNEL?aJ.PU_FUNNEL++:aJ.PU_FUNNEL=1,b.resolve(!0)):(y--,console.log(`checkForDoneDrawing: ${a} < ${s.length}, tries: ${y}`),setTimeout(t,100))}t()}else b.resolve(!1)}),b},a.PUMath=function(){if(!a.config.Powerups.mathPU)return;let b=[];$(h).each((h,g)=>{let c=$(g);c.parents(".grid-tile");let e=c.text();if(!e.includes(S))return;a.config.Powerups.debug&&console.log("Powerup: math power-up found");let d=0;if(e.includes("prio=")){let f=e.match(/prio=([0-9]+)/);f.length>1&&(d=Number(f[1])),isNaN(d)&&(d=0)}c.data("puMathPrio",d),b.push(c)}),b.sort((a,b)=>$(b).data("puMathPrio")-$(a).data("puMathPrio")),$(b).each((e,c)=>{let b=$(c),d=b.parents(".grid-tile");b.text(),aT(d,"PU_Math targetted for deprecation. Please use Metric Expressions."),b.children(".powerupMath").remove(),b.children().each((E,v)=>{let g=$(v),l=g.text();if(!l.includes(S))return;let c=aP(l,S),m=(c.find(a=>"exp"==a[0])||[])[1].replace(/ /g,""),w=c.find(a=>"scope"==a[0])[1],n=(c.find(a=>"color"==a[0])||[])[1]||"white",o=(c.find(a=>"size"==a[0])||[])[1]||"36px",p=(c.find(a=>"base"==a[0])||[])[1]||"",i=Number((c.find(a=>"warn"==a[0])||[])[1]),j=Number((c.find(a=>"crit"==a[0])||[])[1]),x="true"==(c.find(a=>"dates"==a[0])||[])[1],y=(c.find(a=>"timeunit"==a[0])||[])[1]||"ms",z="false"!=(c.find(a=>"full"==a[0])||[])[1],q=(c.find(a=>"currency"==a[0])||[])[1];Number((c.find(a=>"prio"==a[0])||[])[1]);let h=(c.find(a=>"unit"==a[0])||[])[1],A=Number((c.find(a=>"dig"==a[0])||[])[1])||2,f=w.trim().split(",").map(a=>a.includes(":")?{name:a.split(":")[0],link:a.split(":")[1]}:{name:a,link:a});if(f.forEach(b=>{if(b.val=a.findLinkedVal(b.link,S),void 0!==h&&(b.unit=a.findLinkedUnit(b.link,S)),x){let c=new Date(b.val).getTime();isNaN(c)||(b.val=c)}isNaN(Number(b.val))&&console.log(`Powerup: WARN - ${S} - NaN: 

${JSON.stringify({exp:m,scope:f,val:b.val})}`)}),void 0!==h){let B=!0;f.forEach(b=>{let a=aD.find(a=>a.unit==b.unit);a&&a.conversions.find(a=>a.unit==h)||(B=!1)}),B?f.forEach(a=>{let b=aD.find(b=>b.unit==a.unit).conversions.find(a=>a.unit==h);a.val*=b.factor}):h=void 0}let r=f.map(a=>({type:3,token:a.name,show:a.name,value:a.name}))||[],s={};f.forEach(a=>{s[a.name]=a.val});let e;try{e=mexp.eval(m,r,s)}catch(t){let u=`Powerup: CRITICAL - ${S} - ${t.name}: ${t.message}.

${JSON.stringify({exp:m,tokens:r,pairs:s})}`;console.log(u),aS(u)}if(void 0===e)return!1;if(x)switch(y){case"s":e/=1e3;break;case"m":e/=6e4;break;case"h":e/=36e5;break;case"d":e/=864e5}let C,k=(C=q?Intl.NumberFormat(void 0,{style:"currency",currency:q}).format:Intl.NumberFormat(void 0,{maximumFractionDigits:A}).format)(e);h&&(k+=` ${h}`);let d;if(z){b.hide();let D=$("<div>").addClass("powerupMath").insertAfter(b);d=$("<h1>").text(k).css("font-size",o).appendTo(D)}else g.hide(),(d=$("<h1>").text(k).css("font-size",o).addClass("powerupMath").insertAfter(g)).siblings().addClass("powerupMathText"),g.parent().attr("class","");if(d.parent().siblings(".powerupMath").addClass("powerupOverridden"),d.parent().siblings(".powerupVlookup").addClass("powerupOverridden"),!p||isNaN(i)||isNaN(j))d.css("color",n);else switch(p){case"low":e<i?d.addClass("powerup-color-normal"):e<j?d.addClass("powerup-color-warning"):d.addClass("powerup-color-critical");break;case"high":e>i?d.addClass("powerup-color-normal"):e>j?d.addClass("powerup-color-warning"):d.addClass("powerup-color-critical");break;default:d.css("color",n)}aJ.PU_MATH?aJ.PU_MATH++:aJ.PU_MATH=1})})},a.PUCompare=function(){if(!a.config.Powerups.comparePU)return;let b=0;return $(d).each((q,l)=>{let h=$(l),j=h.parents(".grid-tile"),k=h.text(),d=j.find(i);if(!k.includes(V))return;a.config.Powerups.debug&&console.log("Powerup: compare power-up found");let c=aP(k,V),m=c.find(a=>"link"==a[0])[1],n=(c.find(a=>"lt"==a[0])||[])[1]||"green",o=(c.find(a=>"gt"==a[0])||[])[1]||"red",p=(c.find(a=>"eq"==a[0])||[])[1]||"yellow",f=a.findLinkedVal(m,V),g=Number(j.find(e).text().replace(/,/g,""));if(g<f)d.css("color",n);else if(g>f)d.css("color",o);else{if(g!==f)return!0;d.css("color",p)}b++,aJ.PU_COMPARE?aJ.PU_COMPARE++:aJ.PU_COMPARE=1}),b},a.PUmCompare=function(){if(!a.config.Powerups.comparePU)return;let b=0;return $([d,h].join(", ")).each((u,r)=>{let m=$(r),n=m.parents(".grid-tile"),o=m.text(),f=n.find(e);if(!o.includes(W))return;a.config.Powerups.debug&&console.log("Powerup: mcompare power-up found");let c=aP(o,W),d=c.find(a=>"links"==a[0])[1].trim();"string"==typeof d&&d.length&&(d=d.split(","));let g=(c.find(a=>"low"==a[0])||[])[1]||"green";g=g.trim();let h=(c.find(a=>"high"==a[0])||[])[1]||"red";h=h.trim();let i=(c.find(a=>"other"==a[0])||[])[1]||"gray";i=i.trim();let j=(c.find(a=>"mode"==a[0])||[])[1]||"outlier";j=j.trim();let p=[];d.forEach(c=>{let b=a.findLinkedVal(c,W);isNaN(b)||p.push(b)});let k=Math.min.apply(Math,p),q=Math.max.apply(Math,p),l=Number(n.find(e).text().replace(/[,a-zA-Z %]/g,""));if("scale"===j){let s=(l-k)/(q-k),t=d3.interpolateHsl(g,h)(s);f.css("color",t)}else l===k?f.css("color",g):l===q?f.css("color",h):f.css("color",i);b++,aJ.PU_MCOMPARE?aJ.PU_MCOMPARE++:aJ.PU_MCOMPARE=1}),b},a.puDate=function(){if(a.config.Powerups.datePU){if("undefined"==typeof dateFns){let b=`Powerup: CRITICAL - ${T} - dateFns module not loaded!`;return console.log(b),aS(b),!1}$(h).each((h,g)=>{let b=$(g);b.parents(".grid-tile");let c=b.text(),d=b.html();if(!c.includes(T))return;b.hide();let e=$("<div>").html(d).addClass("powerupDate").insertAfter(b),f=c.match(/(!PU\(date\):[^ ]+)/g);f&&f.forEach(c=>{c=c.trim(),a.config.Powerups.debug&&console.log("Powerup: date power-up found");let e=aP(c,T),f=(e.find(a=>"res"==a[0])||[])[1],g=(e.find(a=>"fmt"==a[0])||[])[1];"string"==typeof g&&(g=g.replace(/_/g," "));let j=(e.find(a=>"color"==a[0])||[])[1],k=(e.find(a=>"size"==a[0])||[])[1]||"20px",l=$(E).text(),m=$(F).text();f=f.replace(/_/g," ").replace(/\$gtss/g,l).replace(/\$gtse/g,m);let b=dtDateMath.resolve(f);if(!Array.isArray(b)||b.length<3){let h=`Powerup: ERROR - ${T} - dtDateMath did not return a valid result for: "${f}"`;return console.log(h),aS(h),!0}b[0],b[1];let n=b[2].start,o=dateFns.format(n,g),i=$("<div>");$("<span>").text(o).css("color",j).css("font-size",k).css("font-weight","bold").appendTo(i),d=d.replace(c,i.html()),aJ.PU_DATE?aJ.PU_DATE++:aJ.PU_DATE=1}),e.html(d),e.find("[href*=dmpgdhbpdodhddciokonbahhbpaalmco]").parent().hide()})}},a.puGauge=function(){return!!a.config.Powerups.gaugePU&&($(d).each((z,v)=>{let h=$(v),i=h.parents(f),j=h.text();if(j.includes(U)){new $.Deferred;let b=i.find(r),a=aP(j,U);if(a.length<2){let k="Powerup: ERROR - invalid argstring: "+a.argstring;return console.log(k),aS(k),!1}let c=(a.find(a=>"stops"==a[0])||[])[1];if(!c)return!1;c=c.split(",").map(a=>Number(a.replace(/,/g,"")));let d=(a.find(a=>"colors"==a[0])||[])[1];if(!d)return!1;d=d.split(",");let l=Number((a.find(a=>"min"==a[0])||[])[1]||0),m=Number((a.find(a=>"max"==a[0])||[])[1]||100),n=[];c.forEach((a,b)=>{let c=[a,d[b]];n.push(c)});let w=Number((a.find(a=>"digits"==a[0])||[])[1]||1);aN(i,".powerupGauge"),b.hide();let x=Number(b.find(e).text().replace(/,/g,"")),o=b.find(s).text(),p=b.find(t).text(),y=$("<div>").addClass("powerupGauge").insertAfter(b),q=[l,m];n.forEach(a=>{q.push(a[0]*m)}),q=q.sort((a,b)=>a-b);var u={chart:{type:"solidgauge",backgroundColor:"#353535"},title:null,pane:{center:["50%","35%"],startAngle:-90,endAngle:90,background:{backgroundColor:"#454646",innerRadius:"60%",outerRadius:"100%",shape:"arc",borderColor:"#454646"}},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!1},yAxis:{stops:n,lineWidth:0,tickWidth:1,minorTickInterval:null,tickPositioner:()=>q,tickPosition:"outside",labels:{y:16,style:{color:"#ffffff"},formatter:function(){return this.value===l||this.value===m?this.value:""}},title:{text:o,y:-70,style:{color:"#ffffff"}},min:l,max:m,endOnTick:!1},series:[{name:o,data:[x],dataLabels:{format:`<div style="text-align:center"><span style="font-size:25px">{y:.${w}f}</span><span style="font-size:12px;opacity:0.4">${p}</span></div>`,color:"#ffffff",borderWidth:0,y:-20},tooltip:{valueSuffix:` ${p}`}}]};let g=Highcharts.charts.filter(a=>void 0!==a).filter(a=>a.container===y[0])[0];g?g.update(u,!0,!1):g=Highcharts.chart(y[0],u,()=>{}),aJ.PU_GAUGE?aJ.PU_GAUGE++:aJ.PU_GAUGE=1}}),!0)},a.extDisclaimer=function(){$(h).each((c,b)=>{let a=$(b);a.text().includes("Powerup Enabled Dashboard")&&a.is(":visible")&&(a.hide(),$(f).each((c,b)=>{let a=$(b).css("top");a=Number(a=a.substr(0,a.length-2)),a-=76,a+="px",$(b).css("top",a)}))})},a.sunburnMode=function(){if(!a.config.Powerups.sunburnMode)return!1;$('[data-page-content="canvas"]').find("*").filter((b,a)=>$(a).css("color")===d3.rgb("white").toString()).css("color","black"),$('[data-page-content="canvas"]').find("div").filter((c,b)=>{let a=$(b).css("background-color");return a===d3.rgb("#343434").toString()||a===d3.rgb("#242424").toString()||a===d3.rgb("#353535").toString()}).css("background-color","white"),$('[data-page-content="canvas"]').find("rect").filter((c,b)=>{let a=$(b).css("fill");return a===d3.rgb("#454646").toString()||a===d3.rgb("#242424").toString()||a===d3.rgb("#353535").toString()}).css("fill","white"),$(".powerupPlotBackground").css("fill","white"),$("#powerupSunburnMode").length||$("<style>").html(`
                    [data-custom-charting-item-id-hash] div {
                        border-color: white !important;
                    }
                `).attr("id","powerupSunburnMode").appendTo("head"),aJ.PU_SUNBURN?aJ.PU_SUNBURN++:aJ.PU_SUNBURN=1},a.fixPublicDashboards=function(){$(".grid-tile").each((c,b)=>{let a=$(b);"none"===a.css("pointer-events")&&a.css("pointer-events","auto")})},a.PUvlookup=function(){return $(h).each((aa,L)=>{let h=$(L),y=h.text();if(h.parents(f),y.includes(X)){let d=aP(y,X),i=(d.find(a=>"color"==a[0])||["white"])[1],z=(d.find(a=>"link"==a[0])||[])[1],ab=(d.find(a=>"val"==a[0])||[""])[1],p=(d.find(a=>"col"==a[0])||[1])[1],m=Number((d.find(a=>"row"==a[0])||[])[1]),A=(d.find(a=>"base"==a[0])||[])[1]||"",q=Number((d.find(a=>"warn"==a[0])||[])[1]),r=Number((d.find(a=>"crit"==a[0])||[])[1]),M=(d.find(a=>"notfound"==a[0])||[])[1]||null,N=(d.find(a=>"size"==a[0])||[])[1]||"36px",B=(d.find(a=>"unit"==a[0])||[1])[1],O=Number((d.find(a=>"dig"==a[0])||[])[1])||2,P="true"===(d.find(a=>"string"==a[0])||[])[1],C=(d.find(a=>"as"==a[0])||[])[1],D=a.findLinkedTile(z,X);if(void 0===D)return!0;let Q=$(D),e=aQ(Q,!1);if(!e|| void 0===e.keys||!e.keys.length){let E=`POWERUP: WARN - ${X} - no columns found in table.`;return console.log(E),aS(E),!0}let ac=e.keys[0],s;s=m>0?m>e.normalTable.length?-1:m-1:m<0?e.normalTable.length-1+m:e.normalTable.findIndex(a=>a[ac]===ab);let c,R=Number.isNaN(Number(p))?p:e.keys[Number(p)];if(s<0){let S="POWERUP: WARN - vlookup val not found in table.";console.log(S),c=M}else if(c=e.normalTable[s][R],P);else{let t=Intl.NumberFormat(void 0,{maximumFractionDigits:O}).format;if(void 0!==B){let u="string"==typeof c?(c.match(/[^0-9]+$/)||[])[0]:"",n="string"==typeof c?Number(c.replace(/[,a-zA-Z %]/g,"")):c;if(void 0!==u&&!isNaN(n)){u=u.trim();let F=aD.find(a=>a.unit==u);if(F){let v=F.conversions.find(a=>a.unit==B);v&&v.factor&&(n*=v.factor,c=`${n=t(n)} ${B}`)}}}else if("string"==typeof c){let T=c.includes("%"),G=c.replace(/[,a-zA-Z %]/g,""),H=G.length?Number(G):NaN;isNaN(H)||(c=t(H)),T&&(c+=" %")}else"number"==typeof c&&(c=t(c));let w=(d.find(a=>"compareTable"==a[0])||[])[1],U=(d.find(a=>"compareVal"==a[0])||[])[1];if(w&&U){let x=(d.find(a=>"compareCol"==a[0])||[1])[1],V=(d.find(a=>"lt"==a[0])||["red"])[1],W=(d.find(a=>"eq"==a[0])||["yellow"])[1],Y=(d.find(a=>"gt"==a[0])||["green"])[1],g;if(z===w)g=e;else{let I=a.findLinkedTile(w,X+"-compareLink");if(void 0===I)return!1;let Z=$(I);g=aQ(Z)}if(!g|| void 0===g.keys||!g.keys.length){let J=`POWERUP: WARN - ${X} - no columns found in compareTable.`;return console.log(J),aS(J),!0}let ad=g.keys[0],K=g.normalTable.findIndex(a=>a[ad]===U);if(K<0)console.log("POWERUP: WARN - vlookup compareVal not found in table.");else{let _=Number.isNaN(x)?x:g.keys[x],o=g.normalTable[K][_],j,k;"string"==typeof c&&(j=Number(c.replace(/[,a-zA-Z %]/g,""))),"number"==typeof c&&(j=c),"string"==typeof o&&(k=Number(o.replace(/[,a-zA-Z %]/g,""))),"number"==typeof o&&(k=o),Number.isNaN(j)||Number.isNaN(k)?console.log("POWERUP: WARN - vlookup could not compare vals."):j<k?i=V:j===k?i=W:j>k&&(i=Y)}}else if(A&&!isNaN(q)&&!isNaN(r)){let l;switch("string"==typeof c&&(l=Number(c.replace(/[,a-zA-Z %]/g,""))),"number"==typeof c&&(l=c),A){case"low":i=l<q?"green":l<r?"yellow":"red";break;case"high":i=l>q?"green":l>r?"yellow":"red"}}}h.hide(),h.parent().children(".powerupVlookup").remove(),C&&b(h,C,c);let ae=$("<div>").addClass("powerupVlookup").insertAfter(h);h.children().each((e,d)=>{let a=$(d).clone().appendTo(ae);a.text().includes(X)?a.addClass("powerupVlookupToBeSwapped"):C&&b(a,C,c)}),$("<h1>").css("color",i).css("font-size",N).text(c).replaceAll(".powerupVlookupToBeSwapped"),aJ.PU_VLOOKUP?aJ.PU_VLOOKUP++:aJ.PU_VLOOKUP=1}}),!0;function b(k,c,b){let e=$(k),f=e.html(),a=f,g="${"+c+"}",h="$"+encodeURIComponent("{"+c+"}"),d="${"+c+".enc}",i="$"+encodeURIComponent("{"+c+".enc}"),j=encodeURIComponent(d);a.includes(g)&&(a=a.replace(new RegExp("\\"+g,"g"),b)),a.includes(h)&&(a=a.replace(new RegExp("\\"+h,"g"),b)),a.includes(d)&&(a=a.replace(new RegExp("\\"+d,"g"),encodeURIComponent(b))),a.includes(i)&&(a=a.replace(new RegExp("\\"+i,"g"),encodeURIComponent(b))),a.includes(j)&&(a=a.replace(new RegExp("\\"+j,"g"),encodeURIComponent(b))),a!=f&&e.html(a)}},a.PUtable=function(){return $(d).each((q,j)=>{let e=$(j),a=e.parents(f),c=e.text();if(c.includes(_)){let d=a.find(m),g=a.find(".powerupNewTable");g.length&&(d=g);let b=aP(c,_);c=c.split(_)[0].trim();let r=Number((b.find(a=>"col"==a[0])||[])[1]),k="false"!=(b.find(a=>"scroll"==a[0])||[])[1];d.addClass("powerupTable"),k&&d.addClass("powerupTableScroll"),a.find('[uitestid="gwt-debug-DTAQL"] > a').prependTo(a.find('[uitestid="gwt-debug-DTAQL"]'));let l=aQ(a,!1),h=$("<div>").addClass("powerupTableMenu").appendTo(a),n=$("<a>").addClass("powerupTableButton").attr("href","javascript:;").text("...").appendTo(h),i=$("<div>").css("display","none").appendTo(h),o=$("<a>").addClass("powerupTableButton").attr("href","javascript:;").text("CSV").appendTo(i),p=$("<a>").addClass("powerupTableButton").attr("href","javascript:;").text("XLS").appendTo(i);if(d.off("click").on("click",a=>{a.stopImmediatePropagation()}),n.on("click",()=>{i.toggle(),h.toggleClass("on")}),o.on("click",()=>{var b,d,a;if(!l)return!1;let e=l.keys.join(",")+"\n";l.normalTable.forEach(a=>{l.keys.forEach(b=>{a[b].includes(",")?e+=`"${a[b]}",`:e+=a[b]+","}),e+="\n"}),b=c+".csv",d=e,(a=document.createElement("a")).setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(d)),a.setAttribute("download",b),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}),p.on("click",()=>{let a=c+".xlsx",b=c;!function(b,c,d){if("undefined"==typeof XLSX)return!1;let a=XLSX.utils.book_new(),e=XLSX.utils.json_to_sheet(d);XLSX.utils.book_append_sheet(a,e,c),XLSX.writeFile(a,b)}(a,b,l.normalTable)}),b&&b.url&&b.url.length){let s=/\${([\w]+)}/g;l.normalTable.forEach(f=>{let a=b.url,g=[...a.matchAll(s)];for(let d=g.length-1;d>=0;d--){let c=g[d],e=c[1];if(l.keys.includes(e)){let h=f[e]||"";a=a.slice(0,c.index)+h+a.slice(c.index+c[0].length),f.link=a}else console.log(`key not found: ${e} in `,l.keys)}})}a.find(u).each((b,e)=>{let a=$(e);a.hide(),a.siblings(".powerupTableCol").remove();let c=$("<a>").attr("href","javascript:;").addClass("powerupTableCol").text(a.text()).insertAfter(a).on("click",e=>{if(!l)return!1;let f=l.keys[b],a;c.hasClass("powerupTableColAsc")?($(".powerupTableColAsc, .powerupTableColDesc").removeClass(["powerupTableColAsc","powerupTableColDesc"]),c.addClass("powerupTableColDesc"),a=l.normalTable.sort((a,b)=>(function(b,c,a){switch(typeof b[a]){case"number":return c[a]-b[a];case"string":if(!(b[a].match(/^[0-9]/)&&c[a].match(/^[0-9]/)))return c[a].toLowerCase()<b[a].toLowerCase()?-1:1;{let d=Number(b[a].replace(/[^0-9.]*/g,"")),e=Number(c[a].replace(/[^0-9.]*/g,""));return e-d}default:return!1}})(a,b,f))):($(".powerupTableColAsc, .powerupTableColDesc").removeClass(["powerupTableColAsc","powerupTableColDesc"]),c.addClass("powerupTableColAsc"),a=l.normalTable.sort((a,b)=>(function(b,c,a){switch(typeof b[a]){case"number":return b[a]-c[a];case"string":if(!(b[a].match(/^[0-9]/)&&c[a].match(/^[0-9]/)))return b[a].toLowerCase()<c[a].toLowerCase()?-1:1;{let d=Number(b[a].replace(/[^0-9.]*/g,"")),e=Number(c[a].replace(/[^0-9.]*/g,""));return d-e}default:return!1}})(a,b,f))),a.forEach((a,b)=>{l.keys.forEach((e,f)=>{let c=d.find(`div > div:nth-of-type(${f+1}) > div:nth-of-type(${b+2}) > span`),g=d.find(`div > div:nth-of-type(${f+1}) > div:nth-of-type(${b+2}) > a`);if(c&&c.length){if(0===f&&a.link&&a.link.length){let h=$("<a>").text(a[e]).attr("href",a.link);c.replaceWith(h)}else c.text(a[e])}g&&g.length&&g.text(a[e]).attr("href",a.link)})})});r===b+1?c.addClass("powerupTableColDesc"):r=== -1*(b+1)&&c.addClass("powerupTableColAsc")}),a.find("a.powerupTableColDesc, a.powerupTableColAsc").eq(0).trigger("click"),aJ.PU_TABLE?aJ.PU_TABLE++:aJ.PU_TABLE=1}}),!0},a.PUstdev=function(){return $(d).each((n,h)=>{let d=$(h),e=d.text(),b=d.parents(f);if(e.includes(Y)){let g=aP(e,Y),o=(g.find(a=>"color"==a[0])||["white"])[1],i=(g.find(a=>"output"==a[0])||["output","stdev"])[1].split(","),a=aQ(b);if(!a)return!1;let p=a.keys[0],j=a.normalTable.reduce((a,b)=>a+b[p],0),q=j/a.normalTable.length,r=Math.sqrt(a.normalTable.map(b=>{let a=b[p]-q;return a*a}).reduce((a,b)=>a+b,0)/a.normalTable.length),c=a.normalTable.sort((a,b)=>a[p]-b[p]).map(a=>a[p]),k=c.length,s=c[k-1],t=c[0],u=d=>{let b=(k-1)*d,a=Math.floor(b),e=b-a;return void 0!==c[a+1]?c[a]+e*(c[a+1]-c[a]):c[a]},l=b.find(m);l.hide(),b.find(".powerupStdev").remove(),i.forEach(b=>{let a;switch(b.toLowerCase()){case"stdev":a=r.toLocaleString(void 0,{maximumFractionDigits:2});break;case"avg":a=q.toLocaleString(void 0,{maximumFractionDigits:2});break;case"sum":a=j.toLocaleString(void 0,{maximumFractionDigits:2});break;case"max":a=s.toLocaleString(void 0,{maximumFractionDigits:2});break;case"min":a=t.toLocaleString(void 0,{maximumFractionDigits:2});break;case"median":a=u(.5).toLocaleString(void 0,{maximumFractionDigits:2});break;default:b.includes("%")&&(a=u(Number(b.replace(/%/g,""))/100).toLocaleString(void 0,{maximumFractionDigits:2}))}$("<div>").addClass("powerupStdev").css("color",o).html(`${b}: <span>${a}</span>`).insertBefore(l)}),aJ.PU_STDEV?aJ.PU_STDEV++:aJ.PU_STDEV=1}}),!0},a.PUhoneycomb=function(){let b="#C93234",c="#8EC355",e="#f5d30f";return $(d).each((F,z)=>{let q=$(z),r=q.text(),n=q.parents(f);if(r.includes(ah)){aT(n,"PU_Honeycomb deprecated. Please use Data Explorer.");let l=aP(r,ah),o=(l.find(a=>"links"==a[0])||["",""])[1].split(",").filter(a=>""!=a),p=(l.argstring.match(/drill=([^ ]+)/)||[])[1];p&&(p=p.trim());let G=(l.find(a=>"base"==a[0])||[])[1]||"",H=Number((l.find(a=>"warn"==a[0])||[])[1]),I=Number((l.find(a=>"crit"==a[0])||[])[1]),d=aQ(n,!0,!0);if(!d){console.log("Powerup: WARN - PU_HONEYCOMB - no table found");return}{let J=d.keys[0],K=d.keys[1];d.normalTable.forEach(a=>{a.name=a[J],a.value=a[K],a.colname=J})}if(Array.isArray(o)&&o.length&&o.forEach(e=>{let c=a.findLinkedTile(e,ah);if(void 0==c)return!1;let b=aQ(c,!0,!0);if(!b)return!1;let f=b.keys[0],g=b.keys[1];b.normalTable.forEach(a=>{a.name=a[f],a.value=a[g],a.colname=f}),d.normalTable=d.normalTable.concat(b.normalTable)}),!d)return;console.log(d);let s=n.find(m);s.hide(),aN(n,".powerupHoneycomb");let A=$("<div>").addClass("powerupHoneycomb").insertAfter(s),B=[];d.keys.length>1?(d.keys[0],d.keys[1]):d.keys[0];let C=d.normalTable.length;function h(g,j,h){if(g>=C)return!1;xt=Math.round(j+h/2),yt=Math.round(Math.sqrt(3)/2*h);let f=d.normalTable[g];if(void 0==f)return!1;let a={name:f.name||" ",value:f.value||0,x:xt,y:yt,events:{click(){if(void 0!=p){let a=p.replace(/\$colname/g,f.colname).replace(/\$name/g,f.name).replace(/\$value/g,f.value);window.location.assign(a)}else void 0!=f.link&&window.location.assign(f.link)}}},i=n.find(D).length>0;"low"===G&&i?a.value<H?a.color=c:a.value>=I?a.color=b:a.color=e:"high"===G&&i?a.value>H?a.color=c:a.value<=I?a.color=b:a.color=e:void 0!=f.color?a.color=f.color:a.color="#cccccc",B.push(a)}let i=0,j=0,g=0;g||h(g++,i,j);for(let k=1;g<C;++k){for(let t=0;t<k;++t)h(g++,++i,j);for(let u=0;u<k-1;++u)h(g++,i,++j);for(let v=0;v<k;++v)h(g++,--i,++j);for(let w=0;w<k;++w)h(g++,--i,j);for(let x=0;x<k;++x)h(g++,i,--j);for(let y=0;y<k;++y)h(g++,++i,--j)}let E={chart:{type:"tilemap",height:"80%",backgroundColor:"#353535"},credits:{enabled:!1},title:null,xAxis:{visible:!1},yAxis:{visible:!1},legend:{enabled:!1},colorAxis:{dataClasses:[{from:0,to:50,color:c,name:"green"},{from:50,to:75,color:e,name:"yellow"},{from:75,to:90,color:"##fd8232",name:"orange"},{from:90,color:b,name:"red"}]},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value:.2f}"},plotOptions:{series:{dataLabels:{enabled:!0,format:"",color:"#000000",style:{textOutline:!1}}}},series:[{name:"data",data:B}]};Highcharts.chart(A[0],E),aJ.PU_HONEYCOMB?aJ.PU_HONEYCOMB++:aJ.PU_HONEYCOMB=1}}),!0},a.PUtreemap=function(){return $(d).each((s,n)=>{let i=$(n),j=i.text(),d=i.parents(f);if(j.includes(aj)){let e=aP(j,aj),g=(e.find(a=>"links"==a[0])||["",""])[1].split(",").filter(a=>""!=a),h=(e.argstring.match(/drill=([^ ]+)/)||[])[1];h&&(h=h.trim());let b=(e.find(a=>"colors"==a[0])||["colors","#7c38a1,#fff29a,#4fd5e0,#debbf3,#ef651f,#f5d30f,#4556d7,#ffa86c,#ffd0ab,#00a1b2,#c9a000,#aeebf0,#748cff"])[1];"string"==typeof b&&(b=b.split(","));let c=aQ(d,!0,!0);if(Array.isArray(g)&&g.length&&g.forEach(f=>{let d=a.findLinkedTile(f,aj);if(void 0==d)return!1;let b=aQ(d,!0,!0);if(!b)return!1;if(JSON.stringify(c.keys)!==JSON.stringify(b.keys)){let e=`POWERUP: ERROR - ${aj} - tried to merge dissimilar tables.`;console.warn(e),aS(e)}c.normalTable=c.normalTable.concat(b.normalTable)}),!c)return!1;console.log(c);let k=d.find(m);k.hide(),aN(d,".powerupTreemap");let o=$("<div>").addClass("powerupTreemap").insertAfter(k),p=[],t=Math.min(c.keys.length-1,5),l={sub:[]};function q(a,d=null,c=null,e=null,f=!0){let b={id:null===c?"root":`l${c}_v${e}`,name:a.str?a.str:" "};null===c&&(c=0),void 0!==d&&(b.parent=d,b.id=d+b.id),void 0!==a.value&&(b.value=a.value),f||p.push(b);let g=0;a.sub.forEach(a=>{q(a,b.id,c+1,g++,!1)})}c.normalTable.forEach(a=>{let b=l;c.keys.forEach((d,e)=>{if(e>=t)return;let f=a[d],c=b.sub.findIndex(a=>a.str===f);if(c<0){c=b.sub.length;let g={str:f,sub:[]};b.sub.push(g)}b=b.sub[c]});let d=c.keys[c.keys.length-1];b.value=a[d]}),console.log(l),q(l);let r={chart:{type:"treemap",height:"70%",backgroundColor:"#353535"},colors:b,credits:{enabled:!1},title:null,xAxis:{visible:!1},yAxis:{visible:!1},legend:{enabled:!1},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value:.2f}"},series:[{type:"treemap",layoutAlgorithm:"squarified",alternateStartingDirection:!0,levelIsConstant:!1,allowDrillToNode:!0,interactByLeaf:!1,levels:[{level:1,borderWidth:3,borderColor:"white",colorByPoint:!0,layoutAlgorithm:"stripes",dataLabels:{enabled:!0,align:"left",verticalAlign:"top",style:{fontSize:"15px",fontWeight:"bold"}}},{level:2,borderWidth:1,borderColor:"gray",layoutAlgorithm:"squarified"}],data:p}]};Highcharts.chart(o[0],r),aJ.PU_TREEMAP?aJ.PU_TREEMAP++:aJ.PU_TREEMAP=1}}),!0},a.hideEarlyAdopter=function(){$('[uitestid="gwt-debug-dashboard-tile-filter-indicator-icon"]').siblings().each((c,b)=>{let a=$(b);"Early Adopter"==a.text()&&(a.hide(),a.parents(f).find(d).css("width","100%"))})},a.PUbackground=function(){let a=!1;$(h).each((j,h)=>{let d=$(h),e=d.text(),i=d.parents(f);if(e.includes(aa)){let g=aP(e,aa);(g.find(a=>"width"==a[0])||["width","100%"])[1];let b=(g.argstring.match(/url=([^ ]+)/)||[])[1];return b&&(b=b.trim()),window.postMessage({PowerUp:"PU_BACKGROUND",url:b,targetSelector:c},"*"),aT(i,"Targetted for Deprecation. Please use built-in image tiles, where possible."),aJ.PU_BACKGROUND?aJ.PU_BACKGROUND++:aJ.PU_BACKGROUND=1,a=!0,!0}}),a||$(".powerupBackground").css("background-image","").removeClass("powerupBackground")},a.PUimage=function(){$(h).each((l,j)=>{let b=$(j),e=b.text(),k=b.parents(f);if(e.includes(aq)){aT(k,"PU_Image deprecated. Please use built-in image tile.");let d=aP(e,aq);(d.find(a=>"width"==a[0])||["width","100%"])[1];let c=(d.argstring.match(/url=([^ ]+)/)||[])[1];c&&(c=c.trim());let a=(d.argstring.match(/out=([^ ]+)/)||[])[1];a&&(a=a.trim()),b.hide(),b.siblings(".powerupImage").remove();let g="PUimage-"+aK(),h=$("<div>").attr("id",g).addClass("powerupImage").insertAfter(b);if(a){let i=$("<a>").attr("href",a).addClass("powerupImage").insertBefore(h);a.startsWith("http")&&i.attr("target","_blank"),h.appendTo(i)}window.postMessage({PowerUp:"PU_IMAGE",url:c,targetSelector:`#${g}`},"*"),aJ.PU_IMAGE?aJ.PU_IMAGE++:aJ.PU_IMAGE=1}})},a.PUfunnelColors=function(){$(d).each((j,h)=>{let c=$(h),d=c.text(),e=c.parents(f);if(d.includes(ab)){let g=aP(d,ab),a=(g.find(a=>"colors"==a[0])||[])[1],b=(g.find(a=>"scale"==a[0])||[])[1];if(a&&(a=a.split(",")),b&&(b=b.split(",")),a&&a.length)e.find(q).find("path").each((b,c)=>{$(c).css("fill",a[b])}),aJ.PU_FUNNELCOLORS?aJ.PU_FUNNELCOLORS++:aJ.PU_FUNNELCOLORS=1;else if(b&&2==b.length){let i=e.find(q).find("path");i.each((a,c)=>{let d=a/i.length,e=d3.interpolateHsl(b[0],b[1])(d);$(c).css("fill",e)}),aJ.PU_FUNNELCOLORS?aJ.PU_FUNNELCOLORS++:aJ.PU_FUNNELCOLORS=1}}})},a.PUtilecss=function(){let a=new RegExp("!PU\\(tilecss\\):`[^`]+`"),b=/[ ]*([\w-]+):[ ]*([^;]+);/g,c=/[uU][rR][lL]\([^)]*\)/;$([d,h].join(", ")).each((j,h)=>{let d=$(h),g=d.parents(f);if(d.text().includes(ad)){aT(g,"PU_Tilecss deprecated due to low usage. Create an issue on GitHub if still needed.");let e=d.text().match(a);if(e&&e.length){let i=e[0];g.attr("style"),[...i.matchAll(b)].forEach(a=>{c.test(a[2].m)||g.css(a[1],a[2])}),aJ.PU_TILECSS?aJ.PU_TILECSS++:aJ.PU_TILECSS=1}}})},a.PUmenu=function(){$([d,h].join(", ")).each((e,c)=>{let a=$(c),b=a.text(),g=a.parents(f);b.includes(af)&&aP(b,af).argObjs.forEach(c=>{let e=(c.argstring.match(/url=([^ ]+)/)||[])[1];e&&(e=e.trim());let h=(c.find(a=>"name"==a[0])||[])[1];if(void 0===e|| void 0===h)return!1;let b;if(c.hasOwnProperty("title")){let i=c.title.toLowerCase().trim().replace(/_/g," ");$(d).each((d,c)=>{let a=$(c);a.text().toLowerCase().trim()===i&&(b=a.parents(f).find(v))}),void 0===b?b=g.find(v):a.hide()}else b=g.find(v);b.parent().show(),b.off(`.PUmenu-${h}`).on(`click.PUmenu-${h}`,function(a){setTimeout(()=>{let b=$(w),c=b.children("a").first().attr("class"),a;b.children("a").each((d,c)=>{let b=$(c);b.text()==h&&(b.attr("href")==e?a=b:b.remove())}),(void 0===a||!a.length)&&(a=$("<a>").attr("href",e).attr("class",c).addClass("powerMenuItem").text(h).appendTo(b),e.startsWith("http")&&a.attr("target","_blank"))},50)}).addClass("powerupMenuIcon"),b.length?aJ.PU_MENU?aJ.PU_MENU++:aJ.PU_MENU=1:console.log("POWERUP: WARN - PU(menu) used but no icon found.")})})},a.PUHideShow=function(){$(v).each((i,g)=>{let c=$(g),a=c.parents(f),h=a.find(d).text(),b=a.find(A),e=a.find(B);function j(){let a=$(w),c=b.is(":visible")?"Hide":"Show";b.toggleClass("powerupHide"),e.toggleClass("powerupHide"),a.children("a").each((e,d)=>{let a,b=$(d);"Hide"==c?a="Show":"Show"==c&&(a="Hide"),b.text()==c&&b.text(a)}),a.parent().parent().css("visibility","hidden")}h.includes(ai)&&(e.is(":visible")||b.text().includes("Tile not configured yet")||b.text().includes("No data."))&&(b.addClass("powerupHide"),e.addClass("powerupHide"),aJ.PU_AUTOHIDE?aJ.PU_AUTOHIDE++:aJ.PU_AUTOHIDE=1),c.on("click",function(a){setTimeout(()=>{let a=$(w),d=a.children("a").first().attr("class"),c,e=b.is(":visible")?"Hide":"Show";a.children("a").each((d,b)=>{let a=$(b);a.text()==e&&(c=a)}),void 0!==c&&c.length||(c=$("<a>").attr("href","javascript:").attr("class",d).addClass("powerMenuItem").text(e).appendTo(a).on("click",j))},50)})})},a.PUgrid=function(){$(".powerupGrid").remove(),$(h).each((k,i)=>{let g=$(i),h=g.text(),j=g.parents(f);if(h.includes(ae)){aT(j,"PU_Grid deprecated due to low usage.");let a=aP(h,ae),l=(a.find(a=>"color"==a[0])||[])[1]||"#454646",c=(a.find(a=>"hor"==a[0])||[])[1];c&&(c=[...c.matchAll(/[0-9]+/g)].map(a=>Number(a)));let d=(a.find(a=>"ver"==a[0])||[])[1];d&&(d=[...d.matchAll(/[0-9]+/g)].map(a=>Number(a)));let m=(a.find(a=>"wid"==a[0])||[])[1]||38,n=(a.find(a=>"margin"==a[0])||[])[1]||4,e=$(b).eq(0),o=Number(e.css("left").replace("px","")),p=Number(e.css("top").replace("px",""));e.css("width"),e.css("height"),c.forEach(c=>{let d=o,a=p+38*c,b=m;a?(a-=n,b+=2*n):b+=1*n,$("<div>").addClass("powerupGrid").css("position","absolute").css("left",`${d}px`).css("top",`${a}px`).css("height",`${b}px`).css("width","100%").css("background",l).css("z-index",0).appendTo(e)}),d.forEach(c=>{let a=o+38*c,d=p,b=m;a?(a-=n,b+=2*n):b+=1*n,$("<div>").addClass("powerupGrid").css("position","absolute").css("left",`${a}px`).css("top",`${d}px`).css("height","100%").css("width",`${b}px`).css("background",l).css("z-index",0).appendTo(e)}),aJ.PU_GRID?aJ.PU_GRID++:aJ.PU_GRID=1}})},a.puTimeOnPage=function(){$(d).each((p,l)=>{let e=$(l),g=e.parents(f),h=e.text();if(h.includes(ak)){let i=g.find(m);aP(h,ak);let b=aQ(g,!1);if(!b||!Array.isArray(b.keys)||!b.keys.length)return;if(b.keys.includes("start")&&b.keys.includes("end")&&b.keys.includes("name")){let j={};b.normalTable.forEach(h=>{let b=aR(h.name),c=aR(h.start,"",!1),d=aR(h.end,"",!1);if(b.length!=c.length||b.length!=d.length){console.warn("WARN - puTimeOnPage mismatched action sizes",{actions:b,starts:c,ends:d});return}if(Array.isArray(b))for(let a=0;a<b.length-1;a++){if(void 0===b[a]|| void 0===d[a]|| void 0===c[a]){console.log(ak+": invalid, skipping...",{actions:b[a],starts:c[a],ends:d[a]});continue}let g=b[a],e=d[a];if("string"!=typeof e){console.warn("WARN - puTimeOnPage loaded is not a string");continue}e=Number(e=e.replace(/[ ,]+/g,""));let f=c[a+1];if("string"!=typeof f){console.warn("WARN - puTimeOnPage next is not a string");continue}if(f=Number(f=f.replace(/[ ,]+/g,"")),isNaN(e)||isNaN(f)){console.warn(`Powerup: WARN - ${ak} - NaN! loaded:${d[a]} next:${c[a+1]}`);continue}let i=f-e;j.hasOwnProperty(g)||(j[g]={}),j[g].hasOwnProperty("data")||(j[g].data=[]),j[g].data.push(i)}});let k=Object.keys(j),d=Object.values(j);k.forEach(b=>{let a=j[b];a.min=Math.min(...a.data),a.max=Math.max(...a.data),a.avg=a.data.reduce((a,b)=>a+b,0)/a.data.length,a.deltas=a.data.map(b=>b-a.avg),a.var=a.deltas.reduce((b,a)=>b+a*a,0)/a.deltas.length,a.stdev=Math.sqrt(a.var)}),i.hide();let n=$("<div>").addClass("powerupNewTable").insertAfter(i),c=$("<div>").addClass("powerupTableGrid").appendTo(n);a(c,"Name",k),a(c,"Min",d.map(a=>a.min)),a(c,"Max",d.map(a=>a.max)),a(c,"Avg",d.map(a=>Math.round(a.avg))),a(c,"Stdev",d.map(a=>Math.round(a.stdev)));let o=c.children().length;c.css("grid-template-columns",`repeat(${o}, minmax(80px, auto))`),aJ.PU_TIMEONPAGE?aJ.PU_TIMEONPAGE++:aJ.PU_TIMEONPAGE=1}}});function a(b,c,d){let a=$("<div>").addClass("powerupTableCol"),e=$("<div>").appendTo(a);$("<span>").text(c).appendTo(e),d.forEach(b=>{let c=$("<div>").appendTo(a);$("<span>").text(b).appendTo(c)}),a.appendTo($(b))}},a.cleanupArtifacts=function(){let a=$(".powerupNewTable, .powerupGrid, .powerupStdev, .powerupVlookup, .powerupDate, .powerupMath, .powerupTooltip");a.length&&(console.log(`Powerup: INFO - Cleaned-up ${a.length} artifacts`),a.remove())},a.addReportButton=function(){return a.addEllipsisButton("ReportButton","Report",PowerupReporting.openReportGenerator),!0},a.addEllipsisButton=function(b,e,f){let c=$(C).find("> div"),d=c.find("> a:visible"),a=d.filter(`#powerup${b}`);a.length||(a=$("<a>").attr("href","javascript:").attr("id",`powerup${b}`).attr("class",d.eq(0).attr("class")).addClass("powerupEllipsisButton").appendTo(c).on("click",f),$("<span>").text(`💎 ${e}`).appendTo(a))},a.PUellipsis=function(){$(h).each((k,h)=>{let b=$(h),d=b.text();if(b.parents(f),d.includes(am)){let e=aP(d,am),c=e.text,i=e.url;if(void 0===c){console.warn(`Powerup: ERROR - ${am} - missing text`);return}if(void 0===i){console.warn(`Powerup: ERROR - ${am} - missing url`);return}let g=c.replace(/ /g,"_").replace(/^[0-9]/,"").replace(/[^a-zA-Z0-9-_:.]/g,"");if(!g.length){console.warn(`Powerup: ERROR - ${am} - unable to make valid id from text`);return}let j=()=>{window.open(i,"_blank").focus()};a.addEllipsisButton(g,c,j),b.hide(),aJ.PU_ELLIPSIS?aJ.PU_ELLIPSIS++:aJ.PU_ELLIPSIS=1}})};let aU=!0;return a.PUMarky=function(){let a=[],b=2500;$(d).each((k,h)=>{let e=$(h),g=e.text(),d=e.parents(f);if(g.includes(an)){let c=aP(g,an),i=Number((c.find(a=>"row"==a[0])||[])[1]);c.find(a=>"timer"==a[0])&&(b=1e3*Number((c.find(a=>"timer"==a[0])||[])[1]));let j=Number((c.find(a=>"tile"==a[0])||[])[1]);d.attr("marky-attr",j),d.attr("marky-row",i),a.push(parseInt($(d).css("left").slice(0,-2)))}});let e=(a=a.sort(function(a,b){return a-b})).length;if(aU){let c=c=>{for(let b=0;b<a.length;b++)$(`.grid-tile[marky-attr=${b+1}][marky-row=1]`).css({left:`${e+b>=a.length?a[(e+b)%a.length]:a[e+b]}px`,transition:"left 0.8s"});0== --e&&(e=a.length),aJ.PU_MARKY?aJ.PU_MARKY++:aJ.PU_MARKY=1};setInterval(c,b),aU=!1}},a.fireAllPowerUps=function(e=!1){let d=new $.Deferred,b=[];a.config.beaconOptOut||function(){if(a.config.Powerups.BeaconOptOut)return!1;a.config.Powerups.debug&&console.log("POWERUP: DEBUG - OpenKit start beacon");let c=$('[debugid="userEmail"]').text(),b=c>""?c:$('[debugid="userName"]').text();b.length||(b="Anonymous");let d=b.includes("@dynatrace.com")||b.includes("@ruxitlabs.com")||location.href.match(/managed[a-z-]*.internal.dynatrace/)?"true":"false",e=($('[uitestid="gwt-debug-systemVerisionSection"]').text().match(/[0-9.]+/)||[])[0],f=$('[uitestid="gwt-debug-dashboardNameLabel"]').text(),g=$('[uitestid="gwt-debug-showMoreTags"]').parent().find('[title="Configurator"]').length?"true":"false",h=(($('[uitestid="gwt-debug-searchField"] div input').attr("placeholder")||"").match(/Search Dynatrace (.+).../)||[])[1],i={tenantId:tenantId,host:location.host,dashboardID:(location.hash.match(/id=([0-9a-f-]+)/)||[])[1],internalUser:d,dtVersion:e,dbName:f,configuratorTag:g,envName:h,libLocation:a.config.Powerups.libLocation,uuid:a.config.Powerups.uuid};window.postMessage({OpenKit:"start_beacon",action:"PowerUp: "+location.href,beaconOptOut:a.config.Powerups.BeaconOptOut,uuid:a.config.Powerups.uuid,applicationVersion:a.VERSION,operatingSystem:(navigator.userAgent.match(/\(([^)]+)\)/)||[])[1],manufacturer:"Chrome",modelId:(navigator.userAgent.match(/Chrome\/([^ ]+)/)||[])[1],screenResolution:[window.innerWidth,window.innerHeight],name:b,vals:i},"*")}();try{a.cleanupArtifacts(),b.push(a.puTimeOnPage()),b.push(a.PUvlookup()),b.push(a.PUstdev()),b.push(a.PUMath()),b.push(a.puDate()),b.push(a.PUHighcharts()),b.push(a.colorPowerUp()),b.push(a.updateSVGPowerUp()),b.push(a.svgPowerUp()),b.push(a.mapPowerUp()),b.push(a.PUfunnel()),b.push(a.PUCompare()),b.push(a.PUmCompare()),b.push(a.PUtable()),b.push(a.PUfunnelColors()),b.push(a.PUTopListColor()),aO("sankey",()=>{b.push(a.sankeyPowerUp())}),b.push(a.PUhoneycomb()),b.push(a.PUtreemap()),b.push(a.puGauge()),b.push(a.PUMarky()),b.push(a.PUbackground()),b.push(a.extDisclaimer()),b.push(a.bannerPowerUp()),b.push(a.PUimage()),b.push(a.PUtilecss()),b.push(a.PUgrid()),b.push(a.sunburnMode()),b.push(a.hideEarlyAdopter()),b.push(a.fixPublicDashboards()),b.push(a.PUmenu()),b.push(a.PUHideShow()),b.push(a.addReportButton()),b.push(a.PUellipsis()),a.loadChartSync()}catch(c){(function(b){if(a.config.Powerups.BeaconOptOut)return!1;a.config.Powerups.debug&&console.log("POWERUP: DEBUG - OpenKit crash beacon"),window.postMessage({OpenKit:"crash_beacon",e:{name:b.name,message:b.message,stack:b.stack}},"*")})(c),console.warn("POWERUP: ERROR ",c)}return $.when.apply($,b).always(function(){let b=a.cleanMarkup();a.config.beaconOptOut||function(){if(a.config.Powerups.BeaconOptOut)return!1;a.config.Powerups.debug&&console.log("POWERUP: DEBUG - OpenKit end beacon");let b=aJ;aJ={},window.postMessage({OpenKit:"end_beacon",vals:b},"*")}(),a.config.Powerups.debug&&console.log("Powerup: DEBUG - fire all PowerUps"+(e?" (update)":"")),$.when(b).always(()=>{d.resolve()})}),d},a.GridObserver=function(){var b={},c={},d={};let e=(b,c)=>{a.config.Powerups.debug&&(console.log("Powerup: DEBUG - mutations happening:"),console.log(b)),clearTimeout(d),d=setTimeout(()=>{f(b,c)},200)},f=(g,h)=>{let e;a.config.Powerups.debug&&console.log("Powerup: DEBUG - mutations have stopped."),c.disconnect(),(window.location.hash.startsWith("#dashboard;")||window.location.hash.startsWith("#dashboard/dashboard;"))&&(!$('[uitestid="gwt-debug-dashboardGrid"]').length||$(".loader:visible").length||$('[uitestid="gwt-debug-tileLoader"]:visible').length?(clearTimeout(d),d=setTimeout(()=>{f(g,h)},1e3)):e=a.fireAllPowerUps(),$.when(e).done(()=>{b.observeGrid()}))};return b.launchGridObserver=()=>{c=new MutationObserver(e),b.observeGrid(),d=setTimeout(()=>{f(void 0,void 0)},1e3)},b.observeGrid=()=>{let a=$(".grid-dashboard");if(a.length<1)return!1;a.each((b,a)=>{c.observe(a,{attributes:!0,childList:!0,subtree:!1})});let b=$('[uitestid="gwt-debug-title"]');b.length&&b.each((b,a)=>{c.observe(a,{attributes:!0,childList:!0,subtree:!1})})},b}(),a}()